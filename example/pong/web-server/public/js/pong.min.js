!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(){},{}],2:[function(a,b){b.exports=a(1)},{"/Users/jjung/dev/node/pomelo/reckoner/example/pong/node_modules/grunt-browserify/node_modules/browserify/lib/_empty.js":1}],3:[function(a,b){function c(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function d(a){return"function"==typeof a}function e(a){return"number"==typeof a}function f(a){return"object"==typeof a&&null!==a}function g(a){return void 0===a}b.exports=c,c.EventEmitter=c,c.prototype._events=void 0,c.prototype._maxListeners=void 0,c.defaultMaxListeners=10,c.prototype.setMaxListeners=function(a){if(!e(a)||0>a||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},c.prototype.emit=function(a){var b,c,e,h,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||f(this._events.error)&&!this._events.error.length)){if(b=arguments[1],b instanceof Error)throw b;throw TypeError('Uncaught, unspecified "error" event.')}if(c=this._events[a],g(c))return!1;if(d(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(e=arguments.length,h=new Array(e-1),i=1;e>i;i++)h[i-1]=arguments[i];c.apply(this,h)}else if(f(c)){for(e=arguments.length,h=new Array(e-1),i=1;e>i;i++)h[i-1]=arguments[i];for(j=c.slice(),e=j.length,i=0;e>i;i++)j[i].apply(this,h)}return!0},c.prototype.addListener=function(a,b){var e;if(!d(b))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,d(b.listener)?b.listener:b),this._events[a]?f(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,f(this._events[a])&&!this._events[a].warned){var e;e=g(this._maxListeners)?c.defaultMaxListeners:this._maxListeners,e&&e>0&&this._events[a].length>e&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),"function"==typeof console.trace&&console.trace())}return this},c.prototype.on=c.prototype.addListener,c.prototype.once=function(a,b){function c(){this.removeListener(a,c),e||(e=!0,b.apply(this,arguments))}if(!d(b))throw TypeError("listener must be a function");var e=!1;return c.listener=b,this.on(a,c),this},c.prototype.removeListener=function(a,b){var c,e,g,h;if(!d(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],g=c.length,e=-1,c===b||d(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(f(c)){for(h=g;h-->0;)if(c[h]===b||c[h].listener&&c[h].listener===b){e=h;break}if(0>e)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(e,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},c.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],d(c))this.removeListener(a,c);else for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},c.prototype.listeners=function(a){var b;return b=this._events&&this._events[a]?d(this._events[a])?[this._events[a]]:this._events[a].slice():[]},c.listenerCount=function(a,b){var c;return c=a._events&&a._events[b]?d(a._events[b])?1:a._events[b].length:0}},{}],4:[function(a,b){b.exports="function"==typeof Object.create?function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],5:[function(a,b,c){c.endianness=function(){return"LE"},c.hostname=function(){return"undefined"!=typeof location?location.hostname:""},c.loadavg=function(){return[]},c.uptime=function(){return 0},c.freemem=function(){return Number.MAX_VALUE},c.totalmem=function(){return Number.MAX_VALUE},c.cpus=function(){return[]},c.type=function(){return"Browser"},c.release=function(){return"undefined"!=typeof navigator?navigator.appVersion:""},c.networkInterfaces=c.getNetworkInterfaces=function(){return{}},c.arch=function(){return"javascript"},c.platform=function(){return"browser"},c.tmpdir=c.tmpDir=function(){return"/tmp"},c.EOL="\n"},{}],6:[function(a,b,c){(function(a){function b(a,b){for(var c=0,d=a.length-1;d>=0;d--){var e=a[d];"."===e?a.splice(d,1):".."===e?(a.splice(d,1),c++):c&&(a.splice(d,1),c--)}if(b)for(;c--;c)a.unshift("..");return a}function d(a,b){if(a.filter)return a.filter(b);for(var c=[],d=0;d<a.length;d++)b(a[d],d,a)&&c.push(a[d]);return c}var e=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,f=function(a){return e.exec(a).slice(1)};c.resolve=function(){for(var c="",e=!1,f=arguments.length-1;f>=-1&&!e;f--){var g=f>=0?arguments[f]:a.cwd();if("string"!=typeof g)throw new TypeError("Arguments to path.resolve must be strings");g&&(c=g+"/"+c,e="/"===g.charAt(0))}return c=b(d(c.split("/"),function(a){return!!a}),!e).join("/"),(e?"/":"")+c||"."},c.normalize=function(a){var e=c.isAbsolute(a),f="/"===g(a,-1);return a=b(d(a.split("/"),function(a){return!!a}),!e).join("/"),a||e||(a="."),a&&f&&(a+="/"),(e?"/":"")+a},c.isAbsolute=function(a){return"/"===a.charAt(0)},c.join=function(){var a=Array.prototype.slice.call(arguments,0);return c.normalize(d(a,function(a){if("string"!=typeof a)throw new TypeError("Arguments to path.join must be strings");return a}).join("/"))},c.relative=function(a,b){function d(a){for(var b=0;b<a.length&&""===a[b];b++);for(var c=a.length-1;c>=0&&""===a[c];c--);return b>c?[]:a.slice(b,c-b+1)}a=c.resolve(a).substr(1),b=c.resolve(b).substr(1);for(var e=d(a.split("/")),f=d(b.split("/")),g=Math.min(e.length,f.length),h=g,i=0;g>i;i++)if(e[i]!==f[i]){h=i;break}for(var j=[],i=h;i<e.length;i++)j.push("..");return j=j.concat(f.slice(h)),j.join("/")},c.sep="/",c.delimiter=":",c.dirname=function(a){var b=f(a),c=b[0],d=b[1];return c||d?(d&&(d=d.substr(0,d.length-1)),c+d):"."},c.basename=function(a,b){var c=f(a)[2];return b&&c.substr(-1*b.length)===b&&(c=c.substr(0,c.length-b.length)),c},c.extname=function(a){return f(a)[3]};var g="b"==="ab".substr(-1)?function(a,b,c){return a.substr(b,c)}:function(a,b,c){return 0>b&&(b=a.length+b),a.substr(b,c)}}).call(this,a("_process"))},{_process:7}],7:[function(a,b){function c(){}var d=b.exports={};d.nextTick=function(){var a="undefined"!=typeof window&&window.setImmediate,b="undefined"!=typeof window&&window.MutationObserver,c="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(a)return function(a){return window.setImmediate(a)};var d=[];if(b){var e=document.createElement("div"),f=new MutationObserver(function(){var a=d.slice();d.length=0,a.forEach(function(a){a()})});return f.observe(e,{attributes:!0}),function(a){d.length||e.setAttribute("yes","no"),d.push(a)}}return c?(window.addEventListener("message",function(a){var b=a.source;if((b===window||null===b)&&"process-tick"===a.data&&(a.stopPropagation(),d.length>0)){var c=d.shift();c()}},!0),function(a){d.push(a),window.postMessage("process-tick","*")}):function(a){setTimeout(a,0)}}(),d.title="browser",d.browser=!0,d.env={},d.argv=[],d.on=c,d.addListener=c,d.once=c,d.off=c,d.removeListener=c,d.removeAllListeners=c,d.emit=c,d.binding=function(){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(){throw new Error("process.chdir is not supported")}},{}],8:[function(a,b){b.exports=function(a){return a&&"object"==typeof a&&"function"==typeof a.copy&&"function"==typeof a.fill&&"function"==typeof a.readUInt8}},{}],9:[function(a,b,c){(function(b,d){function e(a,b){var d={seen:[],stylize:g};return arguments.length>=3&&(d.depth=arguments[2]),arguments.length>=4&&(d.colors=arguments[3]),p(b)?d.showHidden=b:b&&c._extend(d,b),v(d.showHidden)&&(d.showHidden=!1),v(d.depth)&&(d.depth=2),v(d.colors)&&(d.colors=!1),v(d.customInspect)&&(d.customInspect=!0),d.colors&&(d.stylize=f),i(d,a,d.depth)}function f(a,b){var c=e.styles[b];return c?"["+e.colors[c][0]+"m"+a+"["+e.colors[c][1]+"m":a}function g(a){return a}function h(a){var b={};return a.forEach(function(a){b[a]=!0}),b}function i(a,b,d){if(a.customInspect&&b&&A(b.inspect)&&b.inspect!==c.inspect&&(!b.constructor||b.constructor.prototype!==b)){var e=b.inspect(d,a);return t(e)||(e=i(a,e,d)),e}var f=j(a,b);if(f)return f;var g=Object.keys(b),p=h(g);if(a.showHidden&&(g=Object.getOwnPropertyNames(b)),z(b)&&(g.indexOf("message")>=0||g.indexOf("description")>=0))return k(b);if(0===g.length){if(A(b)){var q=b.name?": "+b.name:"";return a.stylize("[Function"+q+"]","special")}if(w(b))return a.stylize(RegExp.prototype.toString.call(b),"regexp");if(y(b))return a.stylize(Date.prototype.toString.call(b),"date");if(z(b))return k(b)}var r="",s=!1,u=["{","}"];if(o(b)&&(s=!0,u=["[","]"]),A(b)){var v=b.name?": "+b.name:"";r=" [Function"+v+"]"}if(w(b)&&(r=" "+RegExp.prototype.toString.call(b)),y(b)&&(r=" "+Date.prototype.toUTCString.call(b)),z(b)&&(r=" "+k(b)),0===g.length&&(!s||0==b.length))return u[0]+r+u[1];if(0>d)return w(b)?a.stylize(RegExp.prototype.toString.call(b),"regexp"):a.stylize("[Object]","special");a.seen.push(b);var x;return x=s?l(a,b,d,p,g):g.map(function(c){return m(a,b,d,p,c,s)}),a.seen.pop(),n(x,r,u)}function j(a,b){if(v(b))return a.stylize("undefined","undefined");if(t(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}return s(b)?a.stylize(""+b,"number"):p(b)?a.stylize(""+b,"boolean"):q(b)?a.stylize("null","null"):void 0}function k(a){return"["+Error.prototype.toString.call(a)+"]"}function l(a,b,c,d,e){for(var f=[],g=0,h=b.length;h>g;++g)f.push(F(b,String(g))?m(a,b,c,d,String(g),!0):"");return e.forEach(function(e){e.match(/^\d+$/)||f.push(m(a,b,c,d,e,!0))}),f}function m(a,b,c,d,e,f){var g,h,j;if(j=Object.getOwnPropertyDescriptor(b,e)||{value:b[e]},j.get?h=j.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):j.set&&(h=a.stylize("[Setter]","special")),F(d,e)||(g="["+e+"]"),h||(a.seen.indexOf(j.value)<0?(h=q(c)?i(a,j.value,null):i(a,j.value,c-1),h.indexOf("\n")>-1&&(h=f?h.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+h.split("\n").map(function(a){return"   "+a}).join("\n"))):h=a.stylize("[Circular]","special")),v(g)){if(f&&e.match(/^\d+$/))return h;g=JSON.stringify(""+e),g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.substr(1,g.length-2),g=a.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=a.stylize(g,"string"))}return g+": "+h}function n(a,b,c){var d=0,e=a.reduce(function(a,b){return d++,b.indexOf("\n")>=0&&d++,a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0);return e>60?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function o(a){return Array.isArray(a)}function p(a){return"boolean"==typeof a}function q(a){return null===a}function r(a){return null==a}function s(a){return"number"==typeof a}function t(a){return"string"==typeof a}function u(a){return"symbol"==typeof a}function v(a){return void 0===a}function w(a){return x(a)&&"[object RegExp]"===C(a)}function x(a){return"object"==typeof a&&null!==a}function y(a){return x(a)&&"[object Date]"===C(a)}function z(a){return x(a)&&("[object Error]"===C(a)||a instanceof Error)}function A(a){return"function"==typeof a}function B(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function C(a){return Object.prototype.toString.call(a)}function D(a){return 10>a?"0"+a.toString(10):a.toString(10)}function E(){var a=new Date,b=[D(a.getHours()),D(a.getMinutes()),D(a.getSeconds())].join(":");return[a.getDate(),J[a.getMonth()],b].join(" ")}function F(a,b){return Object.prototype.hasOwnProperty.call(a,b)}var G=/%[sdj%]/g;c.format=function(a){if(!t(a)){for(var b=[],c=0;c<arguments.length;c++)b.push(e(arguments[c]));return b.join(" ")}for(var c=1,d=arguments,f=d.length,g=String(a).replace(G,function(a){if("%%"===a)return"%";if(c>=f)return a;switch(a){case"%s":return String(d[c++]);case"%d":return Number(d[c++]);case"%j":try{return JSON.stringify(d[c++])}catch(b){return"[Circular]"}default:return a}}),h=d[c];f>c;h=d[++c])g+=q(h)||!x(h)?" "+h:" "+e(h);return g},c.deprecate=function(a,e){function f(){if(!g){if(b.throwDeprecation)throw new Error(e);b.traceDeprecation?console.trace(e):console.error(e),g=!0}return a.apply(this,arguments)}if(v(d.process))return function(){return c.deprecate(a,e).apply(this,arguments)};if(b.noDeprecation===!0)return a;var g=!1;return f};var H,I={};c.debuglog=function(a){if(v(H)&&(H=b.env.NODE_DEBUG||""),a=a.toUpperCase(),!I[a])if(new RegExp("\\b"+a+"\\b","i").test(H)){var d=b.pid;I[a]=function(){var b=c.format.apply(c,arguments);console.error("%s %d: %s",a,d,b)}}else I[a]=function(){};return I[a]},c.inspect=e,e.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},e.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},c.isArray=o,c.isBoolean=p,c.isNull=q,c.isNullOrUndefined=r,c.isNumber=s,c.isString=t,c.isSymbol=u,c.isUndefined=v,c.isRegExp=w,c.isObject=x,c.isDate=y,c.isError=z,c.isFunction=A,c.isPrimitive=B,c.isBuffer=a("./support/isBuffer");var J=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];c.log=function(){console.log("%s - %s",E(),c.format.apply(c,arguments))},c.inherits=a("inherits"),c._extend=function(a,b){if(!b||!x(b))return a;for(var c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a}}).call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":8,_process:7,inherits:4}],10:[function(a,b){b.exports={Server:a("./src/ReckonerServer"),GameObject:a("./src/game/GameObject"),PomeloApp:a("./src/pomelo/ReckonerPomeloApp"),EntryHandler:a("./src/pomelo/ReckonerEntryHandler"),RemoteHandler:a("./src/pomelo/ReckonerRemoteHandler"),GateHandler:a("./src/pomelo/ReckonerGateHandler")}},{"./src/ReckonerServer":40,"./src/game/GameObject":41,"./src/pomelo/ReckonerEntryHandler":43,"./src/pomelo/ReckonerGateHandler":44,"./src/pomelo/ReckonerPomeloApp":45,"./src/pomelo/ReckonerRemoteHandler":46}],11:[function(a,b){b.exports=a("./src/HashArray.js")},{"./src/HashArray.js":12}],12:[function(a,b){var c=a("jclass"),d=c._extend({init:function(a,b,c){a=a instanceof Array?a:[a],this._map={},this._list=[],this.callback=b,this.keyFields=a,this.isHashArray=!0,this.options=c||{ignoreDuplicates:!1},b&&b("construct")},addOne:function(a){var b=!1;for(var c in this.keyFields){c=this.keyFields[c];var d=this.objectAt(a,c);if(d)if(this._map[d]){if(this.options.ignoreDuplicates)return;if(-1!=this._map[d].indexOf(a)){b=!0;continue}this._map[d].push(a)}else this._map[d]=[a]}b&&-1!=this._list.indexOf(a)||this._list.push(a)},add:function(){for(var a=0;a<arguments.length;a++)this.addOne(arguments[a]);return this.callback&&this.callback("add",Array.prototype.slice.call(arguments,0)),this},addAll:function(a){if(a.length<100)this.add.apply(this,a);else for(var b=0;b<a.length;b++)this.add(a[b]);return this},addMap:function(a,b){return this._map[a]=b,this.callback&&this.callback("addMap",{key:a,obj:b}),this},intersection:function(a){var b=this;if(!a||!a.isHashArray)throw Error("Cannot HashArray.intersection() on a non-hasharray object. You passed in: ",a);var c=this.clone(null,!0),d=this.clone(null,!0).addAll(this.all.concat(a.all));return d.all.forEach(function(d){b.collides(d)&&a.collides(d)&&c.add(d)}),c},complement:function(a){if(!a||!a.isHashArray)throw Error("Cannot HashArray.complement() on a non-hasharray object. You passed in: ",a);var b=this.clone(null,!0);return this.all.forEach(function(c){a.collides(c)||b.add(c)}),b},get:function(a){return this._map[a]instanceof Array&&1==this._map[a].length?this._map[a][0]:this._map[a]},getAll:function(a){if(a=a instanceof Array?a:[a],"*"==a[0])return this.all;var b=new d(this.keyFields);for(var c in a)b.add.apply(b,this.getAsArray(a[c]));return b.all},getAsArray:function(a){return this._map[a]||[]},getUniqueRandomIntegers:function(a,b,c){var d=[],e={};for(a=Math.min(Math.max(c-b,1),a);d.length<a;){var f=Math.floor(b+Math.random()*(c+1));e[f]||(e[f]=!0,d.push(f))}return d},sample:function(a,b){var c=this.all,d=[];b&&(c=this.getAll(b));for(var e=this.getUniqueRandomIntegers(a,0,c.length-1),f=0;f<e.length;f++)d.push(c[e[f]]);return d},has:function(a){return this._map.hasOwnProperty(a)},collides:function(a){for(var b in this.keyFields)if(this.has(this.objectAt(a,this.keyFields[b])))return!0;return!1},hasMultiple:function(a){return this._map[a]instanceof Array},removeByKey:function(){for(var a=[],b=0;b<arguments.length;b++){var c=arguments[b],d=this._map[c].concat();if(d){a=a.concat(d);for(var e in d){var f=d[e];for(var g in this.keyFields){var h=this.objectAt(f,this.keyFields[g]);if(h&&this._map[h]){var g=this._map[h].indexOf(f);-1!=g&&this._map[h].splice(g,1),0==this._map[h].length&&delete this._map[h]}}this._list.splice(this._list.indexOf(f),1)}}delete this._map[c]}return this.callback&&this.callback("removeByKey",a),this},remove:function(){for(var a=0;a<arguments.length;a++){var b=arguments[a];for(var c in this.keyFields){var d=this.objectAt(b,this.keyFields[c]);if(d){var c=this._map[d].indexOf(b);-1!=c&&this._map[d].splice(c,1),0==this._map[d].length&&delete this._map[d]}}this._list.splice(this._list.indexOf(b),1)}return this.callback&&this.callback("remove",arguments),this},removeAll:function(){var a=this._list.concat();return this._map={},this._list=[],this.callback&&this.callback("remove",a),this},objectAt:function(a,b){if("string"==typeof b)return a[b];for(var c=b.concat();c.length&&a;)a=a[c.shift()];return a},forEach:function(a,b){a=a instanceof Array?a:[a];var c=this.getAll(a);return c.forEach(b),this},forEachDeep:function(a,b,c){a=a instanceof Array?a:[a];var d=this,e=this.getAll(a);return e.forEach(function(a){c(d.objectAt(a,b),a)}),this},clone:function(a,b){var c=new d(this.keyFields.concat(),a?a:this.callback);return b||c.add.apply(c,this.all.concat()),c},sum:function(a,b,c){var d=this,e=0;return this.forEachDeep(a,b,function(a,b){void 0!==c&&(a*=d.objectAt(b,c)),e+=a}),e},average:function(a,b,c){var d=0,e=0,f=0,g=this;return void 0!==c&&this.forEachDeep(a,c,function(a){f+=a}),this.forEachDeep(a,b,function(a,b){void 0!==c&&(a*=g.objectAt(b,c)/f),d+=a,e++}),void 0!==c?d:d/e},filter:function(a,b){function c(a){var c=e.objectAt(a,b);return void 0!==c&&c!==!1}var e=this,f="function"==typeof b?b:c,g=new d(this.keyFields);return g.addAll(this.getAll(a).filter(f)),g}});Object.defineProperty(d.prototype,"all",{get:function(){return this._list}}),Object.defineProperty(d.prototype,"map",{get:function(){return this._map}}),b.exports=d,"undefined"!=typeof window&&(window.HashArray=d)},{jclass:13}],13:[function(a,b,c){!function(a){"function"==typeof define&&define.amd?define([],a):"object"==typeof c?(c=a(),"object"==typeof b&&(b.exports=c)):window?window.Class=a():"object"==typeof console&&console.error instanceof Function&&console.error("cannot determine environment")}(function(){var a=function(a){return a instanceof Function},b=function(a){return void 0===a},c=function(a){return"object"==typeof a},d=function(a){return c(a)&&a.descriptor===!0},e=function(a){var d,e,f,g,h=Array.prototype.slice.call(arguments,1);for(d in h){if(e=h[d],!c(e))return;for(f in e)g=a[f],b(g)&&(a[f]=e[f])}return a},f={_isClassObject:!1},g=!1,h=function(){};return h._subClasses=[],h._extend=function(c,i,j){b(c)&&(c={}),b(i)&&(i={}),b(j)&&(j={}),e(j,f);var k=this,l=function(){g||(this._class=l,this.init&&this.init.apply(this,arguments))};g=!0;var m=new k;g=!1;var n=k.prototype;l.prototype=m,l.prototype.constructor=l,l._superClass=k,l._subClasses=[],k._subClasses.push(l),l._extend=k._extend;var o,p,q;for(o in c)p=c[o],d(p)?Object.defineProperty(m,o,p):(m[o]=p,q=n[o],a(p)&&a(q)&&p!==q&&(p._super=q));if(!j._isClassObject){var r=b(k._members)?h:k._members._class,s={_isClassObject:!0},t=r._extend(i,{},s);l._members=new t}return l._extends=function(a){return this._superClass==h?!1:a==this._superClass||a==h?!0:this._superClass._extends(a)},l},h._convert=function(a,b){var c=a.prototype;return c.init=function(){var b=this;this._origin=h._construct(a,arguments),Object.keys(this._origin).forEach(function(a){b._origin.hasOwnProperty(a)&&Object.defineProperty(b,a,{get:function(){return b._origin[a]}})})},h._extend(c,{},b)},h._construct=function(a,b){var c=function(){return a.apply(this,b||[])};return c.prototype=a.prototype,new c},h})},{}],14:[function(a,b){!function(a){function c(a,b){if("object"!==e(a))return b;for(var d in b)a[d]="object"===e(a[d])&&"object"===e(b[d])?c(a[d],b[d]):b[d];return a}function d(a,b,d){var g=d[0],h=d.length;(a||"object"!==e(g))&&(g={});for(var i=0;h>i;++i){var j=d[i],k=e(j);if("object"===k)for(var l in j){var m=a?f.clone(j[l]):j[l];g[l]=b?c(g[l],m):m}}return g}function e(a){return{}.toString.call(a).slice(8,-1).toLowerCase()}var f=function(a){return d(a===!0,!1,arguments)},g="merge";f.recursive=function(a){return d(a===!0,!0,arguments)},f.clone=function(a){var b,c,d=a,g=e(a);if("array"===g)for(d=[],c=a.length,b=0;c>b;++b)d[b]=f.clone(a[b]);else if("object"===g){d={};for(b in a)d[b]=f.clone(a[b])}return d},a?b.exports=f:window[g]=f}("object"==typeof b&&b&&"object"==typeof b.exports&&b.exports)},{}],15:[function(a,b){function c(){c.init.call(this)}var d={};d.isObject=function(a){return"object"==typeof a&&null!==a},d.isNumber=function(a){return"number"==typeof a},d.isUndefined=function(a){return void 0===a},d.isFunction=function(a){return"function"==typeof a},b.exports=c,c.EventEmitter=c,c.prototype._events=void 0,c.prototype._maxListeners=void 0,c.defaultMaxListeners=10,c.init=function(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0},c.prototype.setMaxListeners=function(a){if(!d.isNumber(a)||0>a||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},c.prototype.emit=function(a){var b,c,e,f,g,h;if(this._events||(this._events={}),"error"===a&&!this._events.error)throw b=arguments[1],b instanceof Error?b:Error('Uncaught, unspecified "error" event.');if(c=this._events[a],d.isUndefined(c))return!1;if(d.isFunction(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(e=arguments.length,f=new Array(e-1),g=1;e>g;g++)f[g-1]=arguments[g];c.apply(this,f)}else if(d.isObject(c)){for(e=arguments.length,f=new Array(e-1),g=1;e>g;g++)f[g-1]=arguments[g];for(h=c.slice(),e=h.length,g=0;e>g;g++)h[g].apply(this,f)}return!0},c.prototype.addListener=function(a,b){var e;if(!d.isFunction(b))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,d.isFunction(b.listener)?b.listener:b),this._events[a]?d.isObject(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,d.isObject(this._events[a])&&!this._events[a].warned){var e;e=d.isUndefined(this._maxListeners)?c.defaultMaxListeners:this._maxListeners,e&&e>0&&this._events[a].length>e&&(this._events[a].warned=!0,d.isFunction(console.error)&&console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),d.isFunction(console.trace)&&console.trace())}return this},c.prototype.on=c.prototype.addListener,c.prototype.once=function(a,b){function c(){this.removeListener(a,c),e||(e=!0,b.apply(this,arguments))}if(!d.isFunction(b))throw TypeError("listener must be a function");var e=!1;return c.listener=b,this.on(a,c),this},c.prototype.removeListener=function(a,b){var c,e,f,g;if(!d.isFunction(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],f=c.length,e=-1,c===b||d.isFunction(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(d.isObject(c)){for(g=f;g-->0;)if(c[g]===b||c[g].listener&&c[g].listener===b){e=g;break}if(0>e)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(e,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},c.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],d.isFunction(c))this.removeListener(a,c);else if(Array.isArray(c))for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},c.prototype.listeners=function(a){var b;return b=this._events&&this._events[a]?d.isFunction(this._events[a])?[this._events[a]]:this._events[a].slice():[]},c.listenerCount=function(a,b){var c;return c=a._events&&a._events[b]?d.isFunction(a._events[b])?1:a._events[b].length:0}},{}],16:[function(a,b){b.exports=a("./lib/pomelo")},{"./lib/pomelo":20}],17:[function(a,b){(function(c,d){var e=a("./util/utils"),f=a("pomelo-logger").getLogger("pomelo",d),g=a("events").EventEmitter,h=a("./util/events"),i=a("./util/appUtil"),j=a("./util/constants"),k=a("./common/manager/appManager"),l=a("fs"),m=a("path"),n=b.exports={},o=1,p=2,q=3,r=4;n.init=function(b){b=b||{},this.options=b,this.loaded=[],this.components={},this.settings={};var c=b.base||m.dirname(a.main.filename);this.set(j.RESERVED.BASE,c,!0),this.event=new g,this.serverId=null,this.serverType=null,this.curServer=null,this.startTime=null,this.master=null,this.servers={},this.serverTypeMaps={},this.serverTypes=[],this.lifecycleCbs={},this.clusterSeq={},i.defaultConfiguration(this),this.state=o,f.info("Application initialized. Server ID: %j",this.getServerId())},n.getBase=function(){return this.get(j.RESERVED.BASE)},n.require=function(b){return a(m.join(n.getBase(),b))},n.configureLogger=function(a){if("off"!==c.env.POMELO_LOGGER){var b=this.getBase(),d=this.get(j.RESERVED.ENV),e=m.join(b,j.FILEPATH.LOG),f=m.join(b,j.FILEPATH.CONFIG_DIR,d,m.basename(j.FILEPATH.LOG));l.existsSync(e)?a.configure(e,{serverId:this.serverId,base:b}):l.existsSync(f)?a.configure(f,{serverId:this.serverId,base:b}):a.error("logger file path configuration is error.")}},n.filter=function(a){this.before(a),this.after(a)},n.before=function(a){w(this,j.KEYWORDS.BEFORE_FILTER,a)},n.after=function(a){w(this,j.KEYWORDS.AFTER_FILTER,a)},n.globalFilter=function(a){this.globalBefore(a),this.globalAfter(a)},n.globalBefore=function(a){w(this,j.KEYWORDS.GLOBAL_BEFORE_FILTER,a)},n.globalAfter=function(a){w(this,j.KEYWORDS.GLOBAL_AFTER_FILTER,a)},n.rpcBefore=function(a){w(this,j.KEYWORDS.RPC_BEFORE_FILTER,a)},n.rpcAfter=function(a){w(this,j.KEYWORDS.RPC_AFTER_FILTER,a)},n.rpcFilter=function(a){this.rpcBefore(a),this.rpcAfter(a)},n.load=function(a,b,c){return"string"!=typeof a&&(c=b,b=a,a="string"==typeof b.name?b.name:null),"function"==typeof b&&(b=b(this,c)),a||"string"!=typeof b.name||(a=b.name),a&&this.components[a]?void f.warn("Application.load(): ignoring duplicate component: %j",a):(this.loaded.push(b),a&&(this.components[a]=b),this)},n.loadConfigBaseApp=function(b,c){var d=this.get(j.RESERVED.ENV),e=m.join(n.getBase(),c),g=m.join(n.getBase(),j.FILEPATH.CONFIG_DIR,d,m.basename(c));if(l.existsSync(e)){var h=a(e);h[d]&&(h=h[d]),this.set(b,h)}else if(l.existsSync(g)){var i=a(g);this.set(b,i)}else f.error("invalid configuration with file path: %s",b)},n.loadConfig=function(b,c){c=a(c),c=c[this.get(j.RESERVED.ENV)]||c,this.set(b,c)},n.setConfig=function(a,b){b=b[this.get(j.RESERVED.ENV)]||b,this.set(a,b)},n.route=function(a,b){var c=this.get(j.KEYWORDS.ROUTE);return c||(c={},this.set(j.KEYWORDS.ROUTE,c)),c[a]=b,this},n.beforeStopHook=function(a){f.warn("this method was deprecated in pomelo 0.8"),a&&"function"==typeof a&&this.set(j.KEYWORDS.BEFORE_STOP_HOOK,a)},n.start=function(a){if(this.startTime=Date.now(),this.state>o)return void e.invokeCallback(a,new Error("application has already start."));var b=this;i.startByType(b,function(){i.loadDefaultComponents(b);var c=function(){i.optComponents(b.loaded,j.RESERVED.START,function(c){b.state=p,c?e.invokeCallback(a,c):(f.info("%j enter after start...",b.getServerId()),b.afterStart(a))})},d=b.lifecycleCbs[j.LIFECYCLE.BEFORE_STARTUP];d?d.call(null,b,c):c()})},n.afterStart=function(a){if(this.state!==p)return void e.invokeCallback(a,new Error("Application is not running now."));var b=this.lifecycleCbs[j.LIFECYCLE.AFTER_STARTUP],c=this;i.optComponents(this.loaded,j.RESERVED.AFTER_START,function(d){c.state=q;var g=c.getServerId();d||f.info("%j finished start",g),b?b.call(null,c,function(){e.invokeCallback(a,d)}):e.invokeCallback(a,d);var i=Date.now()-c.startTime;f.info("Application %j started in %s ms",g,i),c.event.emit(h.START_SERVER,g)})},n.stop=function(a){if(this.state>q)return void f.warn("[pomelo application] application is not running now.");this.state=r;var b=this;this.stopTimer=setTimeout(function(){c.exit(0)},j.TIME.TIME_WAIT_STOP);var d=function(){b.stopTimer&&clearTimeout(b.stopTimer)},g=function(){i.stopComps(b.loaded,0,a,function(){d(),a&&c.exit(0)})},h=this.get(j.KEYWORDS.BEFORE_STOP_HOOK),k=this.lifecycleCbs[j.LIFECYCLE.BEFORE_SHUTDOWN];k?k.call(null,this,g,d):h?e.invokeCallback(h,b,g,d):g()},n.set=function(a,b,c){return 1===arguments.length?this.settings[a]:(this.settings[a]=b,c&&(this[a]=b),this)},n.get=function(a){return this.settings[a]},n.enabled=function(a){return!!this.get(a)},n.disabled=function(a){return!this.get(a)},n.enable=function(a){return this.set(a,!0)},n.disable=function(a){return this.set(a,!1)},n.configure=function(a,b,c){var d=[].slice.call(arguments);return c=d.pop(),a=b=j.RESERVED.ALL,d.length>0&&(a=d[0]),d.length>1&&(b=d[1]),(a===j.RESERVED.ALL||u(this.settings.env,a))&&(b===j.RESERVED.ALL||u(this.settings.serverType,b))&&c.call(this),this},n.registerAdmin=function(a,b,c){var d=this.get(j.KEYWORDS.MODULE);d||(d={},this.set(j.KEYWORDS.MODULE,d)),"string"!=typeof a&&(c=b,b=a,b&&(a=b.moduleId)),a&&(d[a]={moduleId:a,module:b,opts:c})},n.use=function(b,c){if(!b.components)return void f.error("Invalid plugin definition, no plugin.components object exists");var d=this;c=c||{};var e=m.dirname(b.components);return l.existsSync(b.components)?(l.readdirSync(b.components).forEach(function(b){if(/\.js$/.test(b)){var g=m.basename(b,".js"),h=c[g]||{},i=m.join(e,j.DIR.COMPONENT,b);l.existsSync(i)?d.load(a(i),h):f.error("Component %s does not exist at %s",g,i)}}),b.events?l.existsSync(b.events)?void l.readdirSync(b.events).forEach(function(b){if(/\.js$/.test(b)){var c=m.join(e,j.DIR.EVENT,b);l.existsSync(c)?v(a(c),d):f.error("events %s not exist at %s",b,c)}}):void f.error("Failed to find plugin.events at path: %s",b.events):void 0):void f.error("Failed to find plugin.components in file path: %s",b.components)
},n.transaction=function(a,b,c,d){k.transaction(a,b,c,d)},n.getMaster=function(){return this.master},n.getCurServer=function(){return this.curServer},n.getServerId=function(){return this.serverId},n.getServerType=function(){return this.serverType},n.getServers=function(){return this.servers},n.getServersFromConfig=function(){return this.get(j.KEYWORDS.SERVER_MAP)},n.getServerTypes=function(){return this.serverTypes},n.getServerById=function(a){return this.servers[a]},n.getServerFromConfig=function(a){return this.get(j.KEYWORDS.SERVER_MAP)[a]},n.getServersByType=function(a){return this.serverTypeMaps[a]},n.isFrontend=function(a){return a=a||this.getCurServer(),!!a&&"true"===a.frontend},n.isBackend=function(a){return a=a||this.getCurServer(),!!a&&!a.frontend},n.isMaster=function(){return this.serverType===j.RESERVED.MASTER},n.addServers=function(a){if(a&&a.length){for(var b,c,d=0,e=a.length;e>d;d++)b=a[d],this.servers[b.id]=b,c=this.serverTypeMaps[b.serverType],c||(this.serverTypeMaps[b.serverType]=c=[]),s(c,b),this.serverTypes.indexOf(b.serverType)<0&&this.serverTypes.push(b.serverType);this.event.emit(h.ADD_SERVERS,a)}},n.removeServers=function(a){if(a&&a.length){for(var b,c,d,e=0,f=a.length;f>e;e++)b=a[e],c=this.servers[b],c&&(delete this.servers[b],d=this.serverTypeMaps[c.serverType],t(d,b));this.event.emit(h.REMOVE_SERVERS,a)}},n.replaceServers=function(a){if(a){this.servers=a,this.serverTypeMaps={},this.serverTypes=[];var b=[];for(var c in a){var d=a[c],e=d[j.RESERVED.SERVER_TYPE],f=this.serverTypeMaps[e];f||(this.serverTypeMaps[e]=f=[]),this.serverTypeMaps[e].push(d),this.serverTypes.indexOf(e)<0&&this.serverTypes.push(e),b.push(d)}this.event.emit(h.REPLACE_SERVERS,b)}},n.addCrons=function(a){return a&&a.length?void this.event.emit(h.ADD_CRONS,a):void f.warn("crons is not defined.")},n.removeCrons=function(a){return a&&a.length?void this.event.emit(h.REMOVE_CRONS,a):void f.warn("ids is not defined.")};var s=function(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c].id===b.id)return void(a[c]=b);a.push(b)},t=function(a,b){if(a&&a.length)for(var c=0,d=a.length;d>c;c++)if(a[c].id===b)return void a.splice(c,1)},u=function(a,b){if(!b)return!1;for(var c=b.split("|"),d=0,e=c.length;e>d;d++)if(a===c[d])return!0;return!1},v=function(a,b){var c=new a(b);for(var d in c)"function"==typeof c[d]&&b.event.on(d,c[d].bind(c))},w=function(a,b,c){var d=a.get(b);d||(d=[],a.set(b,d)),d.push(c)}}).call(this,a("_process"),"/node_modules/reckoner/node_modules/pomelo/lib/application.js")},{"./common/manager/appManager":18,"./util/appUtil":22,"./util/constants":23,"./util/events":24,"./util/utils":26,_process:7,events:3,fs:1,path:6,"pomelo-logger":28}],18:[function(a,b){(function(c,d){var e=a("async"),f=a("../../util/utils"),g=a("pomelo-logger").getLogger("pomelo",d),h=a("pomelo-logger").getLogger("transaction-log",d),i=a("pomelo-logger").getLogger("transaction-error-log",d),j=b.exports;j.transaction=function(a,b,d,j){if(j||(j=1),"string"!=typeof a)return void g.error("Transaction name formatting error, name was not a string: %s.",a);if("object"!=typeof b)return void g.error("Transaction conditions error, conditions was not an object: %j",b);if("object"!=typeof d)return void g.error("Transaction handlers error, handlers was not an object: %j",d);var k=[],l=[],m=[],n=[];for(var o in b){if("string"!=typeof o||"function"!=typeof b[o])return void g.error("Transaction conditions object format error. Condition '%s' was not a function: %j.",o,b[o]);m.push(o),k.push(b[o])}var p=0;e.forEachSeries(k,function(b,c){b(c),h.info("[%s]:[%s] condition is executed.",a,m[p]),p++},function(b){return b?void c.nextTick(function(){h.error("[%s]:[%s] condition executed with err: %j.",a,m[--p],b.stack);var c={name:a,method:m[p],time:Date.now(),type:"condition",description:b.stack};i.error(JSON.stringify(c))}):void c.nextTick(function(){for(var b in d){if("string"!=typeof b||"function"!=typeof d[b])return void g.error("Transaction handlers object format error. Handler '%s' was not a function: %j.",b,d[b]);n.push(b),l.push(d[b])}var k=!0,m=j;e.whilst(function(){return j>0&&k},function(b){var d=0;j--,e.forEachSeries(l,function(b,c){b(c),h.info("[%s]:[%s] handler is executed.",a,n[d]),d++},function(e){return e?void c.nextTick(function(){h.error("[%s]:[%s]:[%s] handler executed with error: %j.",a,n[--d],m-j,e.stack);var c={name:a,method:n[d],retry:m-j,time:Date.now(),type:"handler",description:e.stack};i.error(JSON.stringify(c)),f.invokeCallback(b)}):(k=!1,f.invokeCallback(b),void c.nextTick(function(){h.info("[%s] all conditions and handlers executed successfully.",a)}))})},function(a){a&&g.error("Transaction process executed with error: %j",a)})})})}}).call(this,a("_process"),"/node_modules/reckoner/node_modules/pomelo/lib/common/manager/appManager.js")},{"../../util/utils":26,_process:7,async:27,"pomelo-logger":28}],19:[function(a,b){(function(c,d){var e=a("child_process"),f=a("pomelo-logger").getLogger("pomelo",d),g=b.exports,h=a("util"),i=a("../util/utils"),j=a("../util/constants"),k=j.RESERVED.ENV_DEV,l=a("os"),m={},n=a("../pomelo");g.runServers=function(a){var b,c,d=a.startId||a.type;switch(d){case j.RESERVED.MASTER:break;case j.RESERVED.ALL:c=a.getServersFromConfig();for(var e in c)this.run(a,c[e]);break;default:if(b=a.getServerFromConfig(d))this.run(a,b);else{c=a.get(j.RESERVED.SERVERS)[d];for(var f=0;f<c.length;f++)this.run(a,c[f])}}},g.run=function(a,b,d){k=a.get(j.RESERVED.ENV);var e,f;if(i.isLocal(b.host)){var l=[];b.args&&l.push("string"==typeof b.args?b.args.trim():b.args),e=a.get(j.RESERVED.MAIN),l.push(e),l.push(h.format("env=%s",k));for(f in b)f===j.RESERVED.CPU&&(m[b.id]=b[f]),l.push(h.format("%s=%s",f,b[f]));g.localrun(c.execPath,null,l,d)}else{e=h.format('cd "%s" && "%s"',a.getBase(),c.execPath);var n=b.args;void 0!==n&&(e+=n),e+=h.format(' "%s" env=%s ',a.get(j.RESERVED.MAIN),k);for(f in b)f===j.RESERVED.CPU&&(m[b.id]=b[f]),e+=h.format(" %s=%s ",f,b[f]);g.sshrun(e,b.host,d)}},g.bindCpu=function(a,b,c){if(l.platform()===j.PLATFORM.LINUX&&void 0!==m[a])if(i.isLocal(c)){var d=[];d.push("-pc"),d.push(m[a]),d.push(b),g.localrun(j.COMMAND.TASKSET,null,d)}else{var e=h.format('taskset -pc "%s" "%s"',m[a],b);g.sshrun(e,c,null)}},g.kill=function(a,b){for(var c,d=0;d<b.length;d++){var e=b[d];if(i.isLocal(e.host)){var f=[];l.platform()===j.PLATFORM.WIN?(c=j.COMMAND.TASKKILL,f.push("/pid"),f.push("/f")):(c=j.COMMAND.KILL,f.push(-9)),f.push(a[d]),g.localrun(c,null,f)}else c=l.platform()===j.PLATFORM.WIN?h.format("taskkill /pid %s /f",a[d]):h.format("kill -9 %s",a[d]),g.sshrun(c,e.host)}},g.sshrun=function(a,b,c){var d=[];d.push(b);var e=n.app.get(j.RESERVED.SSH_CONFIG_PARAMS);e&&Array.isArray(e)&&(d=d.concat(e)),d.push(a),f.info("Executing "+a+" on "+b+":22"),o(j.COMMAND.SSH,b,d,c)},g.localrun=function(a,b,c,d){f.info("Executing "+a+" "+c+" locally"),o(a,b,c,d)};var o=function(a,b,d,g){var h=null;if(k===j.RESERVED.ENV_DEV){h=e.spawn(a,d);var i=a===j.COMMAND.SSH?"["+b+"] ":"";h.stderr.on("data",function(a){var b=a.toString();c.stderr.write(b),g&&g(b)}),h.stdout.on("data",function(a){var b=i+a.toString();c.stdout.write(b)})}else h=e.spawn(a,d,{detached:!0,stdio:"inherit"}),h.unref();h.on("exit",function(b){0!==b&&f.warn("child process exit with error, error code: %s, executed command: %s",b,a),"function"==typeof g&&g(0===b?null:b)})}}).call(this,a("_process"),"/node_modules/reckoner/node_modules/pomelo/lib/master/starter.js")},{"../pomelo":20,"../util/constants":23,"../util/utils":26,_process:7,child_process:1,os:5,"pomelo-logger":28,util:9}],20:[function(a,b){(function(c){function d(a,b,c){if(/\.js$/.test(c)){var d=g.basename(c,".js"),f=e.bind(null,"./components/",d);j[a].__defineGetter__(d,f),b&&j.__defineGetter__(d,f)}}function e(b,c){return a(c?b+c:b)}var f=a("fs"),g=a("path"),h=a("./application"),i=a("./pomeloManager"),j=b.exports={};j.manager=i,j.version="1.1.2",j.events=a("./util/events"),j.components={},j.filters={},j.rpcFilters={},j.connectors={},j.connectors.__defineGetter__("sioconnector",e.bind(null,"./connectors/sioconnector")),j.connectors.__defineGetter__("hybridconnector",e.bind(null,"./connectors/hybridconnector")),j.connectors.__defineGetter__("udpconnector",e.bind(null,"./connectors/udpconnector")),j.connectors.__defineGetter__("mqttconnector",e.bind(null,"./connectors/mqttconnector")),j.pushSchedulers={},j.pushSchedulers.__defineGetter__("direct",e.bind(null,"./pushSchedulers/direct")),j.pushSchedulers.__defineGetter__("buffer",e.bind(null,"./pushSchedulers/buffer"));var k=this;j.createApp=function(a){var b=h;return b.init(a),k._app=b},Object.defineProperty(j,"app",{get:function(){return k._app}}),f.readdirSync(c+"/components").forEach(d.bind(void 0,"components",!0)),f.readdirSync(c+"/filters/handler").forEach(d.bind(void 0,"filters",!0)),f.readdirSync(c+"/filters/rpc").forEach(d.bind(void 0,"rpcFilters",!1))}).call(this,"/node_modules/reckoner/node_modules/pomelo/lib")},{"./application":17,"./pomeloManager":21,"./util/events":24,fs:1,path:6}],21:[function(a,b){(function(c,d){function e(a){console.log(C),s(function(b){m(a,function(d){d?(c.stdin.destroy(),f(a,b)):n("Destination is not empty, continue? (y/n) [no] ",function(d){c.stdin.destroy(),d?f(a,b):p("Fail to init a project".red)})})})}function f(a,b){var c=u.basename(u.resolve(CUR_DIR,a));q(u.join(d,"../template/"),a),r(u.join(a,"game-server/logs")),r(u.join(a,"shared"));var e=function(a){for(var b=v.readdirSync(a),c=0;c<b.length;c++){var d=u.join(a,b[c]),f=v.statSync(d);"."===d||".."===d||(f.isDirectory()?e(d):v.unlinkSync(d))}v.rmdirSync(a)};setTimeout(function(){switch(b){case"1":for(var d=["game-server/app.js.sio","game-server/app.js.wss","game-server/app.js.mqtt","game-server/app.js.sio.wss","game-server/app.js.udp","web-server/app.js.https","web-server/public/index.html.sio","web-server/public/js/lib/pomeloclient.js","web-server/public/js/lib/pomeloclient.js.wss","web-server/public/js/lib/build/build.js.wss","web-server/public/js/lib/socket.io.js"],f=0;f<d.length;++f)v.unlinkSync(u.resolve(a,d[f]));break;case"2":for(var d=["game-server/app.js","game-server/app.js.wss","game-server/app.js.udp","game-server/app.js.mqtt","game-server/app.js.sio.wss","web-server/app.js.https","web-server/public/index.html","web-server/public/js/lib/component.json","web-server/public/js/lib/pomeloclient.js.wss"],f=0;f<d.length;++f)v.unlinkSync(u.resolve(a,d[f]));v.renameSync(u.resolve(a,"game-server/app.js.sio"),u.resolve(a,"game-server/app.js")),v.renameSync(u.resolve(a,"web-server/public/index.html.sio"),u.resolve(a,"web-server/public/index.html")),e(u.resolve(a,"web-server/public/js/lib/build")),e(u.resolve(a,"web-server/public/js/lib/local"));break;case"3":for(var d=["game-server/app.js.sio","game-server/app.js","game-server/app.js.udp","game-server/app.js.sio.wss","game-server/app.js.mqtt","web-server/app.js","web-server/public/index.html.sio","web-server/public/js/lib/pomeloclient.js","web-server/public/js/lib/pomeloclient.js.wss","web-server/public/js/lib/build/build.js","web-server/public/js/lib/socket.io.js"],f=0;f<d.length;++f)v.unlinkSync(u.resolve(a,d[f]));v.renameSync(u.resolve(a,"game-server/app.js.wss"),u.resolve(a,"game-server/app.js")),v.renameSync(u.resolve(a,"web-server/app.js.https"),u.resolve(a,"web-server/app.js")),v.renameSync(u.resolve(a,"web-server/public/js/lib/build/build.js.wss"),u.resolve(a,"web-server/public/js/lib/build/build.js"));break;case"4":for(var d=["game-server/app.js.sio","game-server/app.js","game-server/app.js.udp","game-server/app.js.wss","game-server/app.js.mqtt","web-server/app.js","web-server/public/index.html","web-server/public/js/lib/pomeloclient.js"],f=0;f<d.length;++f)v.unlinkSync(u.resolve(a,d[f]));v.renameSync(u.resolve(a,"game-server/app.js.sio.wss"),u.resolve(a,"game-server/app.js")),v.renameSync(u.resolve(a,"web-server/app.js.https"),u.resolve(a,"web-server/app.js")),v.renameSync(u.resolve(a,"web-server/public/index.html.sio"),u.resolve(a,"web-server/public/index.html")),v.renameSync(u.resolve(a,"web-server/public/js/lib/pomeloclient.js.wss"),u.resolve(a,"web-server/public/js/lib/pomeloclient.js")),e(u.resolve(a,"web-server/public/js/lib/build")),e(u.resolve(a,"web-server/public/js/lib/local")),v.unlinkSync(u.resolve(a,"web-server/public/js/lib/component.json"));break;case"5":for(var d=["game-server/app.js.sio","game-server/app.js","game-server/app.js.wss","game-server/app.js.mqtt","game-server/app.js.sio.wss","web-server/app.js.https","web-server/public/index.html","web-server/public/js/lib/component.json","web-server/public/js/lib/pomeloclient.js.wss"],f=0;f<d.length;++f)v.unlinkSync(u.resolve(a,d[f]));v.renameSync(u.resolve(a,"game-server/app.js.udp"),u.resolve(a,"game-server/app.js")),e(u.resolve(a,"web-server/public/js/lib/build")),e(u.resolve(a,"web-server/public/js/lib/local"));break;case"6":for(var d=["game-server/app.js","game-server/app.js.wss","game-server/app.js.udp","game-server/app.js.sio","game-server/app.js.sio.wss","web-server/app.js.https","web-server/public/index.html","web-server/public/js/lib/component.json","web-server/public/js/lib/pomeloclient.js.wss"],f=0;f<d.length;++f)v.unlinkSync(u.resolve(a,d[f]));v.renameSync(u.resolve(a,"game-server/app.js.mqtt"),u.resolve(a,"game-server/app.js")),v.renameSync(u.resolve(a,"web-server/public/index.html.sio"),u.resolve(a,"web-server/public/index.html")),e(u.resolve(a,"web-server/public/js/lib/build")),e(u.resolve(a,"web-server/public/js/lib/local"))}for(var g=["game-server/app.js","game-server/package.json","web-server/package.json"],h=0;h<g.length;h++){var i=v.readFileSync(u.resolve(a,g[h])).toString();v.writeFileSync(u.resolve(a,g[h]),i.replace("$",c))}var j=u.resolve(a,"game-server/package.json"),k=v.readFileSync(j).toString();v.writeFileSync(j,k.replace("#",version))},TIME_INIT)}function g(a){a=a||{};var b=a.appFile||u.resolve(a.directory,"app.js");v.existsSync(b)||p(D,b);var d=a.logDir||(a.directory?u.resolve(a.directory,"logs"):void 0);d||p(E),v.existsSync(d)||v.mkdir(d);var e,f=a.type||w.RESERVED.ALL,g=[b,"env="+a.env,"type="+f];a.id&&g.push("startId="+a.id),a.daemon?(e=x(c.execPath,g,{detached:!0,stdio:"ignore"}),e.unref(),console.log(G),c.exit(0)):(e=x(c.execPath,g),e.stdout.on("data",function(a){console.log(a.toString())}),e.stderr.on("data",function(a){console.log(a.toString())}))}function h(a){var b="pomelo_list_"+Date.now();k(b,a,function(a){a.request(co.moduleId,{signal:"list"},function(a,b){a&&console.error(a);var d=[];for(var e in b.msg)d.push(b.msg[e]);var f=function(a,b){return a.serverType<b.serverType?-1:a.serverType>b.serverType?1:a.serverId<b.serverId?-1:a.serverId>b.serverId?1:0};d.sort(f);var g=[];g.push(["serverId","serverType","pid","rss(M)","heapTotal(M)","heapUsed(M)","uptime(m)"]),d.forEach(function(a){g.push([a.serverId,a.serverType,a.pid,a.rss,a.heapTotal,a.heapUsed,a.uptime])}),console.log(cliff.stringifyRows(g,["red","blue","green","cyan","magenta","white","yellow"])),c.exit(0)})})}function i(a,b){if(console.info(A),b.force)return exec(os.platform()===w.PLATFORM.WIN?KILL_CMD_WIN:KILL_CMD_LUX),void c.exit(1);var d="pomelo_terminal_"+Date.now();k(d,b,function(d){d.request(co.moduleId,{signal:a,ids:b.serverIds},function(b,d){b&&console.error(b),"kill"===a&&("ok"===d.code?console.log("All the servers have been terminated!"):console.log("There may be some servers remained:",d.serverIds)),c.exit(0)})})}function j(a){var b="pomelo_restart_"+Date.now(),d=[],e=null;a.id&&d.push(a.id),a.type&&(e=a.type),k(b,a,function(a){a.request(co.moduleId,{signal:"restart",ids:d,type:e},function(a,b){a?console.error(a):b.length?console.info("restart fails server ids: %j",b):console.info(B),c.exit(0)})})}function k(a,b,c){var d=new adminClient({username:b.username,password:b.password,md5:!0});d.connect(a,b.host,b.port,function(a){a&&p(y+a.red),"function"==typeof c&&c(d)})}function l(b){var c=u.join(b.directory,w.FILEPATH.MASTER_HA);v.existsSync(c)||p(F);for(var d=a(c).masterha,e=0;e<d.length;e++){var f=d[e];f.mode=w.RESERVED.STAND_ALONE,f.masterha="true",f.home=b.directory,t(f)}}function m(a,b){v.readdir(a,function(a,c){a&&"ENOENT"!==a.code&&p(z),b(!c||!c.length)})}function n(a,b){o(a,function(a){b(/^ *y(es)?/i.test(a))})}function o(a,b){" "===a[a.length-1]?c.stdout.write(a):console.log(a),c.stdin.setEncoding("ascii"),c.stdin.once("data",function(a){b(a)}).resume()}function p(a,b){console.error(a,b),c.exit(1)}function q(a,b){v.existsSync(a)||p(a+"does not exist."),v.existsSync(b)||(r(b),console.log("   create : ".green+b)),v.readdir(a,function(c,d){c&&p(z);for(var e=0;e<d.length;e++){var f=u.resolve(a,d[e]),g=u.resolve(b,d[e]);v.statSync(f).isFile()?(v.writeFileSync(g,v.readFileSync(f,""),""),console.log("   create : ".green+g)):v.statSync(f).isDirectory()&&q(f,g)}})}function r(a,b){mkdirp(a,493,function(c){if(c)throw c;console.log("   create : ".green+a),"function"==typeof b&&b()})}function s(a){o("Please select underly connector, 1 for websocket(native socket), 2 for socket.io, 3 for wss, 4 for socket.io(wss), 5 for udp, 6 for mqtt: [1]",function(b){switch(b.trim()){case"":a(1);break;case"1":case"2":case"3":case"4":case"5":case"6":a(b.trim());break;default:console.log("Invalid choice! Please input 1 - 5.".red+"\n"),s(a)}})}function t(a){var b,d,e=u.resolve(a.home,"app.js");if(utils.isLocal(a.host)){var f=[];f.push(e);for(d in a)f.push(util.format("%s=%s",d,a[d]));starter.localrun(c.execPath,null,f)}else{b=util.format('cd "%s" && "%s"',a.home,c.execPath),b+=util.format(' "%s" ',e);for(d in a)b+=util.format(" %s=%s ",d,a[d]);starter.sshrun(b,a.host)}}var u=a("path"),v=a("fs"),w=a("./util/constants"),x=a("child_process").spawn,y="Failed to connect to admin console server.",z="Failed to read the file, please check if the application is started legally.",A="Closing the application......\nPlease wait......",B="Successfully restarted server.",C="\nThe default admin user is: \n\n"+"  username".green+": admin\n  "+"password".green+": admin\n\nYou can configure admin users by editing adminUser.json later.\n ",D="Failed to find an appropriate script to run,\nplease check the current work directory or the directory specified by option `--directory`.\n".red,E="Logging directory not defined. Specify as Pomelo.manager.start({logDir: 'blah'}).\n".red,F="Failed to find an appropriate masterha config file, \nplease check the current work directory or the arguments passed to.\n".red,G=("Illegal command format. See `pomelo --help`.\n".red,"The application is now running in the background.\n");b.exports={init:e,start:g,createApplicationAt:f,list:h,terminal:i,restart:j,startMasterha:l}}).call(this,a("_process"),"/node_modules/reckoner/node_modules/pomelo/lib")},{"./util/constants":23,_process:7,child_process:1,fs:1,path:6}],22:[function(a,b){(function(c,d){var e=a("async"),f=a("./log"),g=a("./utils"),h=a("path"),i=a("fs"),j=a("./constants"),k=a("../master/starter"),l=a("pomelo-logger").getLogger("pomelo",d);b.exports.defaultConfiguration=function(a){var b=a.options.args||r(c.argv);p(a,b),n(a),m(a),o(a,b),q(a),s(a)},b.exports.startByType=function(a,b){a.startId?a.startId===j.RESERVED.MASTER?g.invokeCallback(b):k.runServers(a):a.type&&a.type!==j.RESERVED.ALL&&a.type!==j.RESERVED.MASTER?k.runServers(a):g.invokeCallback(b)},b.exports.loadDefaultComponents=function(b){var c=a("../pomelo");b.serverType===j.RESERVED.MASTER?b.load(c.master,b.get("masterConfig")):(b.load(c.proxy,b.get("proxyConfig")),b.getCurServer().port&&b.load(c.remote,b.get("remoteConfig")),b.isFrontend()&&(b.load(c.connection,b.get("connectionConfig")),b.load(c.connector,b.get("connectorConfig")),b.load(c.session,b.get("sessionConfig")),b.get("schedulerConfig")?b.load(c.pushScheduler,b.get("schedulerConfig")):b.load(c.pushScheduler,b.get("pushSchedulerConfig"))),b.load(c.backendSession,b.get("backendSessionConfig")),b.load(c.channel,b.get("channelConfig")),b.load(c.server,b.get("serverConfig"))),b.load(c.monitor,b.get("monitorConfig"))},b.exports.stopComps=function(a,c,d,e){if(c>=a.length)return void g.invokeCallback(e);var f=a[c];"function"==typeof f.stop?f.stop(d,function(){b.exports.stopComps(a,c+1,d,e)}):b.exports.stopComps(a,c+1,d,e)},b.exports.optComponents=function(a,b,c){var d=0;e.forEachSeries(a,function(a,c){d++,"function"==typeof a[b]?a[b](c):c()},function(a){a&&("string"==typeof a?l.error("fail to operate component, method: %s, err: %j",b,a):l.error("fail to operate component, method: %s, err: %j",b,a.stack)),g.invokeCallback(c,a)})};var m=function(a){a.options.servers?a.setConfig(j.RESERVED.SERVERS,a.options.servers):a.loadConfigBaseApp(j.RESERVED.SERVERS,j.FILEPATH.SERVER);var b,c,d,e,f=a.get(j.RESERVED.SERVERS),h={};for(var i in f)for(b=f[i],c=0,d=b.length;d>c;c++)e=b[c],e.serverType=i,e[j.RESERVED.CLUSTER_COUNT]?g.loadCluster(a,e,h):(h[e.id]=e,e.wsPort&&l.warn("wsPort is deprecated, use clientPort in frontend server instead, server: %j",e));a.set(j.KEYWORDS.SERVER_MAP,h)},n=function(a){a.options.master?a.setConfig(j.RESERVED.MASTER,a.options.master):a.loadConfigBaseApp(j.RESERVED.MASTER,j.FILEPATH.MASTER),a.master=a.get(j.RESERVED.MASTER)},o=function(a,b){var c=b.serverType||j.RESERVED.MASTER,d=b.id||a.getMaster().id,e=b.mode||j.RESERVED.CLUSTER,f=b.masterha||"false",g=b.type||j.RESERVED.ALL,h=b.startId;a.set(j.RESERVED.MAIN,b.main,!0),a.set(j.RESERVED.SERVER_TYPE,c,!0),a.set(j.RESERVED.SERVER_ID,d,!0),a.set(j.RESERVED.MODE,e,!0),a.set(j.RESERVED.TYPE,g,!0),h&&a.set(j.RESERVED.STARTID,h,!0),"true"===f?(a.master=b,a.set(j.RESERVED.CURRENT_SERVER,b,!0)):c!==j.RESERVED.MASTER?a.set(j.RESERVED.CURRENT_SERVER,b,!0):a.set(j.RESERVED.CURRENT_SERVER,a.getMaster(),!0)},p=function(a,b){a.set(j.RESERVED.ENV,b.env||c.env.NODE_ENV||j.RESERVED.ENV_DEV,!0)},q=function(a){if("off"!==c.env.POMELO_LOGGER){var b=a.get(j.RESERVED.ENV),d=h.join(a.getBase(),j.FILEPATH.LOG),e=h.join(a.getBase(),j.FILEPATH.CONFIG_DIR,b,h.basename(j.FILEPATH.LOG));i.existsSync(d)?f.configure(a,d):i.existsSync(e)?f.configure(a,e):l.error("logger file path configuration error.")}},r=function(a){for(var b={},c=1;a[c].indexOf("--")>0;)c++;b.main=a[c];for(var d=c+1;d<a.length;d++){var e=a[d],f=e.indexOf("="),g=e.slice(0,f),h=e.slice(f+1);!isNaN(Number(h))&&h.indexOf(".")<0&&(h=Number(h)),b[g]=h}return b},s=function(b){var c=h.join(b.getBase(),j.FILEPATH.SERVER_DIR,b.serverType,j.FILEPATH.LIFECYCLE);if(i.existsSync(c)){var d=a(c);for(var e in d)"function"==typeof d[e]?b.lifecycleCbs[e]=d[e]:l.warn("lifecycle.js in %s is error format.",c)}}}).call(this,a("_process"),"/node_modules/reckoner/node_modules/pomelo/lib/util/appUtil.js")},{"../master/starter":19,"../pomelo":20,"./constants":23,"./log":25,"./utils":26,_process:7,async:27,fs:1,path:6,"pomelo-logger":28}],23:[function(a,b){b.exports={KEYWORDS:{BEFORE_FILTER:"__befores__",AFTER_FILTER:"__afters__",GLOBAL_BEFORE_FILTER:"__globalBefores__",GLOBAL_AFTER_FILTER:"__globalAfters__",ROUTE:"__routes__",BEFORE_STOP_HOOK:"__beforeStopHook__",MODULE:"__modules__",SERVER_MAP:"__serverMap__",RPC_BEFORE_FILTER:"__rpcBefores__",RPC_AFTER_FILTER:"__rpcAfters__",MASTER_WATCHER:"__masterwatcher__",MONITOR_WATCHER:"__monitorwatcher__"},FILEPATH:{MASTER:"/config/master.json",SERVER:"/config/servers.json",CRON:"/config/crons.json",LOG:"/config/log4js.json",SERVER_PROTOS:"/config/serverProtos.json",CLIENT_PROTOS:"/config/clientProtos.json",MASTER_HA:"/config/masterha.json",LIFECYCLE:"/lifecycle.js",SERVER_DIR:"/app/servers/",CONFIG_DIR:"/config"},DIR:{HANDLER:"handler",REMOTE:"remote",CRON:"cron",LOG:"logs",SCRIPT:"scripts",EVENT:"events",COMPONENT:"components"},RESERVED:{BASE:"base",MAIN:"main",MASTER:"master",SERVERS:"servers",ENV:"env",CPU:"cpu",ENV_DEV:"development",ENV_PRO:"production",ALL:"all",SERVER_TYPE:"serverType",SERVER_ID:"serverId",CURRENT_SERVER:"curServer",MODE:"mode",TYPE:"type",CLUSTER:"clusters",STAND_ALONE:"stand-alone",START:"start",AFTER_START:"afterStart",CRONS:"crons",ERROR_HANDLER:"errorHandler",GLOBAL_ERROR_HANDLER:"globalErrorHandler",AUTO_RESTART:"auto-restart",RESTART_FORCE:"restart-force",CLUSTER_COUNT:"clusterCount",CLUSTER_PREFIX:"cluster-server-",CLUSTER_SIGNAL:"++",RPC_ERROR_HANDLER:"rpcErrorHandler",SERVER:"server",CLIENT:"client",STARTID:"startId",STOP_SERVERS:"stop_servers",SSH_CONFIG_PARAMS:"ssh_config_params"},COMMAND:{TASKSET:"taskset",KILL:"kill",TASKKILL:"taskkill",SSH:"ssh"},PLATFORM:{WIN:"win32",LINUX:"linux"},LIFECYCLE:{BEFORE_STARTUP:"beforeStartup",BEFORE_SHUTDOWN:"beforeShutdown",AFTER_STARTUP:"afterStartup",AFTER_STARTALL:"afterStartAll"},SIGNAL:{FAIL:0,OK:1},TIME:{TIME_WAIT_STOP:3e3,TIME_WAIT_KILL:5e3,TIME_WAIT_RESTART:5e3,TIME_WAIT_COUNTDOWN:1e4,TIME_WAIT_MASTER_KILL:12e4,TIME_WAIT_MONITOR_KILL:2e3,TIME_WAIT_PING:3e4,TIME_WAIT_MAX_PING:3e5,DEFAULT_UDP_HEARTBEAT_TIME:2e4,DEFAULT_UDP_HEARTBEAT_TIMEOUT:1e5}}},{}],24:[function(a,b){b.exports={ADD_SERVERS:"add_servers",REMOVE_SERVERS:"remove_servers",REPLACE_SERVERS:"replace_servers",BIND_SESSION:"bind_session",UNBIND_SESSION:"unbind_session",CLOSE_SESSION:"close_session",ADD_CRONS:"add_crons",REMOVE_CRONS:"remove_crons",START_SERVER:"start_server",START_ALL:"start_all"}},{}],25:[function(a,b){var c=a("pomelo-logger");b.exports.configure=function(a,b){var d=a.getServerId(),e=a.getBase();c.configure(b,{serverId:d,base:e})}},{"pomelo-logger":28}],26:[function(a,b){(function(c){var d=a("os"),e=a("util"),f=a("child_process").exec,g=a("pomelo-logger").getLogger("pomelo",c),h=a("./constants"),i=a("../pomelo"),j=b.exports;j.invokeCallback=function(a){a&&"function"==typeof a&&a.apply(null,Array.prototype.slice.call(arguments,1))},j.size=function(a){var b=0;for(var c in a)a.hasOwnProperty(c)&&"function"!=typeof a[c]&&b++;return b},j.endsWith=function(a,b){return"string"!=typeof a||"string"!=typeof b||b.length>a.length?!1:-1!==a.indexOf(b,a.length-b.length)},j.startsWith=function(a,b){return"string"!=typeof a||"string"!=typeof b||b.length>a.length?!1:0===a.indexOf(b)},j.arrayDiff=function(a,b){for(var c={},d=0,e=b.length;e>d;d++)c[b[d]]=!0;var f=[];for(d=0,e=a.length;e>d;d++){var g=a[d];c[g]||f.push(g)}return f},j.format=function(a,b){b=b||"MMddhhmm";var c={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};/(y+)/.test(b)&&(b=b.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length)));for(var d in c)new RegExp("("+d+")").test(b)&&(b=b.replace(RegExp.$1,1===RegExp.$1.length?c[d]:("00"+c[d]).substr((""+c[d]).length)));return b},j.hasChineseChar=function(a){return/.*[\u4e00-\u9fa5]+.*$/.test(a)?!0:!1},j.unicodeToUtf8=function(a){var b,c,d,e="";for(c=a.length,b=0;c>b;b++)d=a.charCodeAt(b),d>=0&&127>=d?e+=a.charAt(b):d>=128&&2047>=d?(e+=String.fromCharCode(192|d>>6&31),e+=String.fromCharCode(128|63&d)):d>=2048&&65535>=d?(e+=String.fromCharCode(224|d>>12&15),e+=String.fromCharCode(128|d>>6&63),e+=String.fromCharCode(128|63&d)):d>=65536&&2097151>=d?(e+=String.fromCharCode(240|d>>18&7),e+=String.fromCharCode(128|d>>12&63),e+=String.fromCharCode(128|d>>6&63),e+=String.fromCharCode(128|63&d)):d>=2097152&&67108863>=d?(e+=String.fromCharCode(248|d>>24&3),e+=String.fromCharCode(128|d>>18&63),e+=String.fromCharCode(128|d>>12&63),e+=String.fromCharCode(128|d>>6&63),e+=String.fromCharCode(128|63&d)):d>=67108864&&2147483647>=d&&(e+=String.fromCharCode(252|d>>30&1),e+=String.fromCharCode(128|d>>24&63),e+=String.fromCharCode(128|d>>18&63),e+=String.fromCharCode(128|d>>12&63),e+=String.fromCharCode(128|d>>6&63),e+=String.fromCharCode(128|63&d));return e},j.ping=function(a,c){if(b.exports.isLocal(a))c(!0);else{var d="ping -w 15 "+a;f(d,function(a){return a?void c(!1):void c(!0)})}},j.checkPort=function(a,b){if(!a.port&&!a.clientPort)return void this.invokeCallback(b,"leisure");{var c=this,d=a.port||a.clientPort,j=a.host,k=function(a,b,c){var d,f=i.app.get(h.RESERVED.SSH_CONFIG_PARAMS);return f=f&&Array.isArray(f)?f.join(" "):"",d=a.isLocal(b)?e.format("netstat -an|awk '{print $4}'|grep %s|wc -l",c):e.format("ssh %s %s \"netstat -an|awk '{print $4}'|grep %s|wc -l\"",b,f,c)},l=k(c,j,d);f(l,function(e,h){if(e)g.error("command %s execute with error: %j",l,e.stack),c.invokeCallback(b,"error");else if("0"!==h.trim())c.invokeCallback(b,"busy");else{d=a.clientPort;var i=k(c,j,d);f(i,function(a,d){a?(g.error("command %s execute with error: %j",i,a.stack),c.invokeCallback(b,"error")):"0"!==d.trim()?c.invokeCallback(b,"busy"):c.invokeCallback(b,"leisure")})}})}},j.isLocal=function(b){var c=a("../pomelo").app;return c?"127.0.0.1"===b||"localhost"===b||k(b)||b===c.master.host:"127.0.0.1"===b||"localhost"===b||k(b)},j.loadCluster=function(a,b,c){var d={},e=(b.host,parseInt(b[h.RESERVED.CLUSTER_COUNT])),f=a.clusterSeq[b.serverType];f?a.clusterSeq[b.serverType]=f+e:(f=0,a.clusterSeq[b.serverType]=e);for(var g in b){var i=b[g].toString();if(i.indexOf(h.RESERVED.CLUSTER_SIGNAL)>0){var j=b[g].slice(0,-2);d[g]=j}}for(var k=function(a){var b={};for(var c in a)b[c]=a[c];return b},l=0,m=f;e>l;l++,m++){var n=k(b);n.id=h.RESERVED.CLUSTER_PREFIX+b.serverType+"-"+m;for(var o in d){var p=parseInt(d[o]);n[o]=p+l}c[n.id]=n}},j.extends=function(a,b){if(!b||!m(b))return a;for(var c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a},j.headHandler=function(a){for(var b=0,c=1;4>c;c++)c>1&&(b<<=8),b+=a.readUInt8(c);return b};var k=function(a){for(var b in l)if(a===l[b])return!0;return!1},l=function(){var a=d.networkInterfaces(),b=[],c=function(a){"IPv4"===a.family&&b.push(a.address)};for(var e in a)a[e].forEach(c);return b}(),m=function(a){return"object"==typeof a&&null!==a}}).call(this,"/node_modules/reckoner/node_modules/pomelo/lib/util/utils.js")},{"../pomelo":20,"./constants":23,child_process:1,os:5,"pomelo-logger":28,util:9}],27:[function(a,b){(function(a){!function(){function c(a){var b=!1;return function(){if(b)throw new Error("Callback was already called.");b=!0,a.apply(d,arguments)}}var d,e,f={};d=this,null!=d&&(e=d.async),f.noConflict=function(){return d.async=e,f};var g=function(a,b){if(a.forEach)return a.forEach(b);for(var c=0;c<a.length;c+=1)b(a[c],c,a)},h=function(a,b){if(a.map)return a.map(b);var c=[];return g(a,function(a,d,e){c.push(b(a,d,e))}),c},i=function(a,b,c){return a.reduce?a.reduce(b,c):(g(a,function(a,d,e){c=b(c,a,d,e)}),c)},j=function(a){if(Object.keys)return Object.keys(a);var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b};f.nextTick="undefined"!=typeof a&&a.nextTick?a.nextTick:"function"==typeof setImmediate?function(a){setImmediate(a)}:function(a){setTimeout(a,0)},f.each=function(a,b,d){if(d=d||function(){},!a.length)return d();var e=0;g(a,function(f){b(f,c(function(b){b?(d(b),d=function(){}):(e+=1,e>=a.length&&d(null))}))})},f.forEach=f.each,f.eachSeries=function(a,b,c){if(c=c||function(){},!a.length)return c();var d=0,e=function(){var g=!0;b(a[d],function(b){b?(c(b),c=function(){}):(d+=1,d>=a.length?c(null):g?f.nextTick(e):e())}),g=!1};e()},f.forEachSeries=f.eachSeries,f.eachLimit=function(a,b,c,d){var e=k(b);e.apply(null,[a,c,d])},f.forEachLimit=f.eachLimit;var k=function(a){return function(b,c,d){if(d=d||function(){},!b.length||0>=a)return d();var e=0,f=0,g=0;!function h(){if(e>=b.length)return d();for(;a>g&&f<b.length;)f+=1,g+=1,c(b[f-1],function(a){a?(d(a),d=function(){}):(e+=1,g-=1,e>=b.length?d():h())})}()}},l=function(a){return function(){var b=Array.prototype.slice.call(arguments);return a.apply(null,[f.each].concat(b))}},m=function(a,b){return function(){var c=Array.prototype.slice.call(arguments);return b.apply(null,[k(a)].concat(c))}},n=function(a){return function(){var b=Array.prototype.slice.call(arguments);return a.apply(null,[f.eachSeries].concat(b))}},o=function(a,b,c,d){var e=[];b=h(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c,d){e[a.index]=d,b(c)})},function(a){d(a,e)})};f.map=l(o),f.mapSeries=n(o),f.mapLimit=function(a,b,c,d){return p(b)(a,c,d)};var p=function(a){return m(a,o)};f.reduce=function(a,b,c,d){f.eachSeries(a,function(a,d){c(b,a,function(a,c){b=c,d(a)})},function(a){d(a,b)})},f.inject=f.reduce,f.foldl=f.reduce,f.reduceRight=function(a,b,c,d){var e=h(a,function(a){return a
}).reverse();f.reduce(e,b,c,d)},f.foldr=f.reduceRight;var q=function(a,b,c,d){var e=[];b=h(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c){c&&e.push(a),b()})},function(){d(h(e.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})};f.filter=l(q),f.filterSeries=n(q),f.select=f.filter,f.selectSeries=f.filterSeries;var r=function(a,b,c,d){var e=[];b=h(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c){c||e.push(a),b()})},function(){d(h(e.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})};f.reject=l(r),f.rejectSeries=n(r);var s=function(a,b,c,d){a(b,function(a,b){c(a,function(c){c?(d(a),d=function(){}):b()})},function(){d()})};f.detect=l(s),f.detectSeries=n(s),f.some=function(a,b,c){f.each(a,function(a,d){b(a,function(a){a&&(c(!0),c=function(){}),d()})},function(){c(!1)})},f.any=f.some,f.every=function(a,b,c){f.each(a,function(a,d){b(a,function(a){a||(c(!1),c=function(){}),d()})},function(){c(!0)})},f.all=f.every,f.sortBy=function(a,b,c){f.map(a,function(a,c){b(a,function(b,d){b?c(b):c(null,{value:a,criteria:d})})},function(a,b){if(a)return c(a);var d=function(a,b){var c=a.criteria,d=b.criteria;return d>c?-1:c>d?1:0};c(null,h(b.sort(d),function(a){return a.value}))})},f.auto=function(a,b){b=b||function(){};var c=j(a);if(!c.length)return b(null);var d={},e=[],h=function(a){e.unshift(a)},k=function(a){for(var b=0;b<e.length;b+=1)if(e[b]===a)return void e.splice(b,1)},l=function(){g(e.slice(0),function(a){a()})};h(function(){j(d).length===c.length&&(b(null,d),b=function(){})}),g(c,function(c){var e=a[c]instanceof Function?[a[c]]:a[c],g=function(a){if(a)b(a),b=function(){};else{var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),d[c]=e,f.nextTick(l)}},j=e.slice(0,Math.abs(e.length-1))||[],m=function(){return i(j,function(a,b){return a&&d.hasOwnProperty(b)},!0)&&!d.hasOwnProperty(c)};if(m())e[e.length-1](g,d);else{var n=function(){m()&&(k(n),e[e.length-1](g,d))};h(n)}})},f.waterfall=function(a,b){if(b=b||function(){},!a.length)return b();var c=function(a){return function(d){if(d)b.apply(null,arguments),b=function(){};else{var e=Array.prototype.slice.call(arguments,1),g=a.next();e.push(g?c(g):b),f.nextTick(function(){a.apply(null,e)})}}};c(f.iterator(a))()};var t=function(a,b,c){if(c=c||function(){},b.constructor===Array)a.map(b,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);c.length<=1&&(c=c[0]),b.call(null,a,c)})},c);else{var d={};a.each(j(b),function(a,c){b[a](function(b){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),d[a]=e,c(b)})},function(a){c(a,d)})}};f.parallel=function(a,b){t({map:f.map,each:f.each},a,b)},f.parallelLimit=function(a,b,c){t({map:p(b),each:k(b)},a,c)},f.series=function(a,b){if(b=b||function(){},a.constructor===Array)f.mapSeries(a,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);c.length<=1&&(c=c[0]),b.call(null,a,c)})},b);else{var c={};f.eachSeries(j(a),function(b,d){a[b](function(a){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),c[b]=e,d(a)})},function(a){b(a,c)})}},f.iterator=function(a){var b=function(c){var d=function(){return a.length&&a[c].apply(null,arguments),d.next()};return d.next=function(){return c<a.length-1?b(c+1):null},d};return b(0)},f.apply=function(a){var b=Array.prototype.slice.call(arguments,1);return function(){return a.apply(null,b.concat(Array.prototype.slice.call(arguments)))}};var u=function(a,b,c,d){var e=[];a(b,function(a,b){c(a,function(a,c){e=e.concat(c||[]),b(a)})},function(a){d(a,e)})};f.concat=l(u),f.concatSeries=n(u),f.whilst=function(a,b,c){if(a()){var d=!0;b(function(e){return e?c(e):void(d?f.nextTick(function(){f.whilst(a,b,c)}):f.whilst(a,b,c))}),d=!1}else c()},f.doWhilst=function(a,b,c){var d=!0;a(function(e){return e?c(e):void(b()?d?f.nextTick(function(){f.doWhilst(a,b,c)}):f.doWhilst(a,b,c):c())}),d=!1},f.until=function(a,b,c){if(a())c();else{var d=!0;b(function(e){return e?c(e):void(d?f.nextTick(function(){f.until(a,b,c)}):f.until(a,b,c))}),d=!1}},f.doUntil=function(a,b,c){var d=!0;a(function(e){return e?c(e):void(b()?c():d?f.nextTick(function(){f.doUntil(a,b,c)}):f.doUntil(a,b,c))}),d=!1},f.queue=function(a,b){function d(a,c,d,e){c.constructor!==Array&&(c=[c]),g(c,function(c){var g={data:c,callback:"function"==typeof e?e:null};d?a.tasks.unshift(g):a.tasks.push(g),a.saturated&&a.tasks.length===b&&a.saturated(),f.nextTick(a.process)})}var e=0,h={tasks:[],concurrency:b,saturated:null,empty:null,drain:null,push:function(a,b){d(h,a,!1,b)},unshift:function(a,b){d(h,a,!0,b)},process:function(){if(e<h.concurrency&&h.tasks.length){var b=h.tasks.shift();h.empty&&0===h.tasks.length&&h.empty(),e+=1;var d=!0,g=function(){e-=1,b.callback&&b.callback.apply(b,arguments),h.drain&&h.tasks.length+e===0&&h.drain(),h.process()},i=c(function(){var a=arguments;d?f.nextTick(function(){g.apply(null,a)}):g.apply(null,arguments)});a(b.data,i),d=!1}},length:function(){return h.tasks.length},running:function(){return e}};return h},f.cargo=function(a,b){var c=!1,d=[],e={tasks:d,payload:b,saturated:null,empty:null,drain:null,push:function(a,c){a.constructor!==Array&&(a=[a]),g(a,function(a){d.push({data:a,callback:"function"==typeof c?c:null}),e.saturated&&d.length===b&&e.saturated()}),f.nextTick(e.process)},process:function i(){if(!c){if(0===d.length)return void(e.drain&&e.drain());var f="number"==typeof b?d.splice(0,b):d.splice(0),j=h(f,function(a){return a.data});e.empty&&e.empty(),c=!0,a(j,function(){c=!1;var a=arguments;g(f,function(b){b.callback&&b.callback.apply(null,a)}),i()})}},length:function(){return d.length},running:function(){return c}};return e};var v=function(a){return function(b){var c=Array.prototype.slice.call(arguments,1);b.apply(null,c.concat([function(b){var c=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(b?console.error&&console.error(b):console[a]&&g(c,function(b){console[a](b)}))}]))}};f.log=v("log"),f.dir=v("dir"),f.memoize=function(a,b){var c={},d={};b=b||function(a){return a};var e=function(){var e=Array.prototype.slice.call(arguments),f=e.pop(),g=b.apply(null,e);g in c?f.apply(null,c[g]):g in d?d[g].push(f):(d[g]=[f],a.apply(null,e.concat([function(){c[g]=arguments;var a=d[g];delete d[g];for(var b=0,e=a.length;e>b;b++)a[b].apply(null,arguments)}])))};return e.memo=c,e.unmemoized=a,e},f.unmemoize=function(a){return function(){return(a.unmemoized||a).apply(null,arguments)}},f.times=function(a,b,c){for(var d=[],e=0;a>e;e++)d.push(e);return f.map(d,b,c)},f.timesSeries=function(a,b,c){for(var d=[],e=0;a>e;e++)d.push(e);return f.mapSeries(d,b,c)},f.compose=function(){var a=Array.prototype.reverse.call(arguments);return function(){var b=this,c=Array.prototype.slice.call(arguments),d=c.pop();f.reduce(a,c,function(a,c,d){c.apply(b,a.concat([function(){var a=arguments[0],b=Array.prototype.slice.call(arguments,1);d(a,b)}]))},function(a,c){d.apply(b,[a].concat(c))})}},"undefined"!=typeof define&&define.amd?define([],function(){return f}):"undefined"!=typeof b&&b.exports?b.exports=f:d.async=f}()}).call(this,a("_process"))},{_process:7}],28:[function(a,b){b.exports=a("./lib/logger")},{"./lib/logger":29}],29:[function(a,b){(function(c){function d(a){for(var b=arguments,d="",e=1;e<b.length;e++)e!==b.length-1?d=d+b[e]+"] [":d+=b[e];"string"==typeof a&&(a=a.replace(c.cwd(),""));var f=u.getLogger(a),g={};for(var h in f)g[h]=f[h];return["log","debug","info","warn","error","trace","fatal"].forEach(function(a){g[a]=function(){var e="";c.env.RAW_MESSAGE||(b.length>1&&(e="["+d+"] "),b.length&&c.env.LOGGER_LINE&&(e=q()+": "+e),e=t(e,A[a])),b.length&&(arguments[0]=e+arguments[0]),f[a].apply(f,arguments)}}),g}function e(a,b){y.timerId&&(clearInterval(y.timerId),delete y.timerId),y.filename=a,y.lastMTime=f(a),y.timerId=setInterval(h,1e3*b)}function f(a){var b;try{b=v.statSync(a).mtime}catch(c){throw new Error("Cannot find file with given path: "+a)}return b}function g(a){return a?JSON.parse(v.readFileSync(a,"utf8")):void 0}function h(){var a=f(y.filename);a&&(y.lastMTime&&a.getTime()>y.lastMTime.getTime()&&i(g(y.filename)),y.lastMTime=a)}function i(a){if(a)try{j(a.levels),a.replaceConsole?u.replaceConsole():u.restoreConsole()}catch(b){throw new Error("Problem reading log4js config "+w.inspect(a)+'. Error was "'+b.message+'" ('+b.stack+")")}}function j(a){if(a)for(var b in a)a.hasOwnProperty(b)&&u.getLogger(b).setLevel(a[b])}function k(a,b){var d=a;a=a||c.env.LOG4JS_CONFIG,b=b||{},"string"==typeof a&&(a=JSON.parse(v.readFileSync(a,"utf8"))),a&&(a=l(a,b)),a&&a.lineDebug&&(c.env.LOGGER_LINE=!0),a&&a.rawMessage&&(c.env.RAW_MESSAGE=!0),d&&a&&a.reloadSecs&&e(d,a.reloadSecs),u.configure(a,b)}function l(a,b){if(a instanceof Array)for(var c=0,d=a.length;d>c;c++)a[c]=l(a[c],b);else if("object"==typeof a){var e;for(var f in a)a.hasOwnProperty(f)&&(e=a[f],"string"==typeof e?a[f]=m(e,b):"object"==typeof e&&(a[f]=l(e,b)))}return a}function m(a,b){if(!a)return a;for(var c,d,e,f,g,h,i,j=/\$\{(.*?)\}/g,k="",l=0;c=j.exec(a);)d=c[1],e=d.split(":"),2===e.length||3===e.length?(f=e[0],g=e[1],3===e.length&&(h=e[2]),i=x[f],i||"function"==typeof i?(k+=a.substring(l,c.index),l=j.lastIndex,k+=i(g,b)||h):k+=d):k+=d;return l<a.length&&(k+=a.substring(l)),k}function n(a){return c.env[a]}function o(a){return c.argv[a]}function p(a,b){return b?b[a]:void 0}function q(){var a=new Error,b=a.stack.split("\n")[3].split(":")[1];return b}function r(a){return a?"["+z[a][0]+"m":""}function s(a){return a?"["+z[a][1]+"m":""}function t(a,b){return r(b)+a+s(b)}var u=a("log4js"),v=a("fs"),w=a("util"),x={env:n,args:o,opts:p},y={},z={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[90,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},A={all:"grey",trace:"blue",debug:"cyan",info:"green",warn:"yellow",error:"red",fatal:"magenta",off:"grey"};b.exports={getLogger:d,getDefaultLogger:u.getDefaultLogger,addAppender:u.addAppender,loadAppender:u.loadAppender,clearAppenders:u.clearAppenders,configure:k,replaceConsole:u.replaceConsole,restoreConsole:u.restoreConsole,levels:u.levels,setGlobalLogLevel:u.setGlobalLogLevel,layouts:u.layouts,appenders:u.appenders}}).call(this,a("_process"))},{_process:7,fs:1,log4js:34,util:9}],30:[function(a,b,c){"use strict";function d(a,b){b="object"==typeof b?b||{}:b?{format:b}:{};var c=a,d=g.toLevel(b.level,g.INFO),i=b.format||h,j=b.nolog?f(b.nolog):null;return function(a,f,h){if(a._logging)return h();if(j&&j.test(a.originalUrl))return h();if(c.isLevelEnabled(d)||"auto"===b.level){{var k,l=new Date,m=f.writeHead,n=f.end;a.originalUrl}a._logging=!0,f.writeHead=function(a,c){f.writeHead=m,f.writeHead(a,c),f.__statusCode=k=a,f.__headers=c||{},"auto"===b.level?(d=g.INFO,a>=300&&(d=g.WARN),a>=400&&(d=g.ERROR)):d=g.toLevel(b.level,g.INFO)},f.end=function(b,g){if(f.end=n,f.end(b,g),f.responseTime=new Date-l,c.isLevelEnabled(d))if("function"==typeof i){var h=i(a,f,function(b){return e(b,a,f)});h&&c.log(d,h)}else c.log(d,e(i,a,f))}}h()}}function e(a,b,c){return a.replace(":url",b.originalUrl).replace(":method",b.method).replace(":status",c.__statusCode||c.statusCode).replace(":response-time",c.responseTime).replace(":date",(new Date).toUTCString()).replace(":referrer",b.headers.referer||b.headers.referrer||"").replace(":http-version",b.httpVersionMajor+"."+b.httpVersionMinor).replace(":remote-addr",b.ip||b._remoteAddress||b.socket&&(b.socket.remoteAddress||b.socket.socket&&b.socket.socket.remoteAddress)).replace(":user-agent",b.headers["user-agent"]||"").replace(":content-length",c._headers&&c._headers["content-length"]||c.__headers&&c.__headers["Content-Length"]||"-").replace(/:req\[([^\]]+)\]/g,function(a,c){return b.headers[c.toLowerCase()]}).replace(/:res\[([^\]]+)\]/g,function(a,b){return c._headers?c._headers[b.toLowerCase()]||c.__headers[b]:c.__headers&&c.__headers[b]})}function f(a){var b=null;if(a&&(a instanceof RegExp&&(b=a),"string"==typeof a&&(b=new RegExp(a)),Array.isArray(a))){var c=a.map(function(a){return a.source?a.source:a});b=new RegExp(c.join("|"))}return b}var g=a("./levels"),h=':remote-addr - - ":method :url HTTP/:http-version" :status :content-length ":referrer" ":user-agent"';c.connectLogger=d},{"./levels":33}],31:[function(a,b,c){"use strict";function d(a,b){for(var c=a+"";c.length<b;)c="0"+c;return c}function e(a){return d(a,2)}function f(a){var b=Math.abs(a.getTimezoneOffset()),c=String(Math.floor(b/60)),d=String(b%60);return 1==c.length&&(c="0"+c),1==d.length&&(d="0"+d),a.getTimezoneOffset()<0?"+"+c+d:"-"+c+d}c.ISO8601_FORMAT="yyyy-MM-dd hh:mm:ss.SSS",c.ISO8601_WITH_TZ_OFFSET_FORMAT="yyyy-MM-ddThh:mm:ssO",c.DATETIME_FORMAT="dd MM yyyy hh:mm:ss.SSS",c.ABSOLUTETIME_FORMAT="hh:mm:ss.SSS",c.asString=function(a){var b=c.ISO8601_FORMAT;"string"==typeof a&&(b=arguments[0],a=arguments[1]);var g=e(a.getDate()),h=e(a.getMonth()+1),i=e(a.getFullYear()),j=e(a.getFullYear().toString().substring(2,4)),k=b.indexOf("yyyy")>-1?i:j,l=e(a.getHours()),m=e(a.getMinutes()),n=e(a.getSeconds()),o=d(a.getMilliseconds(),3),p=f(a),q=b.replace(/dd/g,g).replace(/MM/g,h).replace(/y{1,4}/g,k).replace(/hh/g,l).replace(/mm/g,m).replace(/ss/g,n).replace(/SSS/g,o).replace(/O/g,p);return q}},{}],32:[function(a,b){"use strict";function c(a){return a.map(function(a){return a instanceof Error&&a.stack?{inspect:function(){return p.format(a)+"\n"+a.stack}}:a})}function d(a){var b=Array.isArray(a)?a:Array.prototype.slice.call(arguments);return p.format.apply(p,c(b))}function e(a){return a?"["+s[a][0]+"m":""}function f(a){return a?"["+s[a][1]+"m":""}function g(a,b){return e(b)+a+f(b)}function h(a,b){var c=g(d("[%s] [%s] %s - ",m.asString(a.startTime),a.level,a.categoryName),b);return c}function i(a){return h(a)+d(a.data)}function j(a){return h(a,r[a.level.toString()])+d(a.data)}function k(a){return d(a.data)}function l(a,b){function c(a,b){var c=a.categoryName;if(b){var d=parseInt(b,10),e=c.split(".");d<e.length&&(c=e.slice(e.length-d).join("."))}return c}function g(a,b){var c=m.ISO8601_FORMAT;return b&&(c=b,"ISO8601"==c?c=m.ISO8601_FORMAT:"ISO8601_WITH_TZ_OFFSET"==c?c=m.ISO8601_WITH_TZ_OFFSET_FORMAT:"ABSOLUTE"==c?c=m.ABSOLUTETIME_FORMAT:"DATE"==c&&(c=m.DATETIME_FORMAT)),m.asString(c,a.startTime)}function h(){return n.hostname().toString()}function i(a){return d(a.data)}function j(){return o}function k(a){return a.level.toString()}function l(a){return""+a.startTime.toLocaleTimeString()}function p(a){return e(r[a.level.toString()])}function q(a){return f(r[a.level.toString()])}function s(){return"%"}function t(a,c){return"undefined"!=typeof b[c]?"function"==typeof b[c]?b[c](a):b[c]:null}function u(a,b,c){return z[a](b,c)}function v(a,b){var c;return a?(c=parseInt(a.substr(1),10),b.substring(0,c)):b}function w(a,b){var c;if(a)if("-"==a.charAt(0))for(c=parseInt(a.substr(1),10);b.length<c;)b+=" ";else for(c=parseInt(a,10);b.length<c;)b=" "+b;return b}var x="%r %p %c - %m%n",y=/%(-?[0-9]+)?(\.?[0-9]+)?([\[\]cdhmnprx%])(\{([^\}]+)\})?|([^%]+)/;a=a||x;var z={c:c,d:g,h:h,m:i,n:j,p:k,r:l,"[":p,"]":q,"%":s,x:t};return function(b){for(var c,d="",e=a;c=y.exec(e);){var f=c[0],g=c[1],h=c[2],i=c[3],j=c[5],k=c[6];if(k)d+=""+k;else{var l=u(i,b,j)||f;l=v(h,l),l=w(g,l),d+=l}e=e.substr(c.index+c[0].length)}return d}}var m=a("./date_format"),n=a("os"),o=n.EOL||"\n",p=a("util"),q={messagePassThrough:function(){return k},basic:function(){return i},colored:function(){return j},coloured:function(){return j},pattern:function(a){return l(a&&a.pattern,a&&a.tokens)}},r={ALL:"grey",TRACE:"blue",DEBUG:"cyan",INFO:"green",WARN:"yellow",ERROR:"red",FATAL:"magenta",OFF:"grey"},s={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[90,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};b.exports={basicLayout:i,messagePassThroughLayout:k,patternLayout:l,colouredLayout:j,coloredLayout:j,layout:function(a,b){return q[a]&&q[a](b)}}},{"./date_format":31,os:2,util:9}],33:[function(a,b){"use strict";function c(a,b){this.level=a,this.levelStr=b}function d(a,c){if(!a)return c;if("string"==typeof a){var e=a.toUpperCase();return b.exports[e]?b.exports[e]:c}return d(a.toString())}c.prototype.toString=function(){return this.levelStr},c.prototype.isLessThanOrEqualTo=function(a){return"string"==typeof a&&(a=d(a)),this.level<=a.level},c.prototype.isGreaterThanOrEqualTo=function(a){return"string"==typeof a&&(a=d(a)),this.level>=a.level},c.prototype.isEqualTo=function(a){return"string"==typeof a&&(a=d(a)),this.level===a.level},b.exports={ALL:new c(Number.MIN_VALUE,"ALL"),TRACE:new c(5e3,"TRACE"),DEBUG:new c(1e4,"DEBUG"),INFO:new c(2e4,"INFO"),WARN:new c(3e4,"WARN"),ERROR:new c(4e4,"ERROR"),FATAL:new c(5e4,"FATAL"),OFF:new c(Number.MAX_VALUE,"OFF"),toLevel:d}},{}],34:[function(a,b){(function(c){"use strict";function d(a){return H.hasOwnProperty(a)}function e(a){"string"!=typeof a&&(a=E.DEFAULT_CATEGORY);var b;return d(a)||(H[a]=new E(a),G[a]&&(b=G[a],b.forEach(function(b){H[a].addListener("log",b)})),G[F]&&(b=G[F],b.forEach(function(b){H[a].addListener("log",b)}))),H[a]}function f(){var a=Array.prototype.slice.call(arguments),b=a.shift();(0===a.length||void 0===a[0])&&(a=[F]),Array.isArray(a[0])&&(a=a[0]),a.forEach(function(a){h(b,a),a===F?g(b):d(a)&&H[a].addListener("log",b)})}function g(a){for(var b in H)d(b)&&H[b].addListener("log",a)}function h(a,b){G[b]||(G[b]=[]),G[b].push(a)}function i(){G={};for(var a in H)d(a)&&H[a].removeAllListeners("log")}function j(a,b){i(),a&&a.forEach(function(a){w(a.type);var c;a.makers=I;try{c=I[a.type](a,b),f(c,a.category)}catch(d){throw new Error("log4js configuration problem for "+A.inspect(a),d)}})}function k(a){if(a)for(var b in a)a.hasOwnProperty(b)&&(b===F&&l(a[b]),e(b).setLevel(a[b]))}function l(a){E.prototype.level=C.toLevel(a,C.TRACE)}function m(){return e(E.DEFAULT_CATEGORY)}function n(a){return a?JSON.parse(z.readFileSync(a,"utf8")):void 0}function o(a,b){if(a)try{j(a.appenders,b),k(a.levels),a.replaceConsole?t():u()}catch(c){throw new Error("Problem reading log4js config "+A.inspect(a)+'. Error was "'+c.message+'" ('+c.stack+")")}}function p(){var a=q(L.filename);a&&(L.lastMTime&&a.getTime()>L.lastMTime.getTime()&&o(n(L.filename)),L.lastMTime=a)}function q(a){var b;try{b=z.statSync(L.filename).mtime}catch(c){e("log4js").warn("Failed to load configuration file "+a)}return b}function r(a,b){L.timerId&&(clearInterval(L.timerId),delete L.timerId),L.filename=a,L.lastMTime=q(a),L.timerId=setInterval(p,1e3*b.reloadSecs)}function s(a,b){var d=a;d=d||c.env.LOG4JS_CONFIG,b=b||{},void 0===d||null===d||"string"==typeof d?(b.reloadSecs&&r(d,b),d=n(d)||K):b.reloadSecs&&e("log4js").warn('Ignoring configuration reload parameter for "object" configuration.'),o(d,b)}function t(a){function b(b){return function(){b.apply(a,arguments)}}a=a||e("console"),["log","debug","info","warn","error"].forEach(function(c){console[c]=b("log"===c?a.info:a[c])})}function u(){["log","debug","info","warn","error"].forEach(function(a){console[a]=M[a]})}function v(b){var c;try{c=a("./appenders/"+b)}catch(d){c=a(b)}return c}function w(a,c){if(c=c||v(a),!c)throw new Error("Invalid log4js appender: "+A.inspect(a));b.exports.appenders[a]=c.appender.bind(c),c.shutdown&&(J[a]=c.shutdown.bind(c)),I[a]=c.configure.bind(c)}function x(a){D.disableAllLogWrites();var b=Object.keys(J).reduce(function(a,b){return a.concat(J[b])},[]);y.forEach(b,function(a,b){a(b)},a)}var y=(a("events"),a("async")),z=a("fs"),A=(a("path"),a("util")),B=a("./layouts"),C=a("./levels"),D=a("./logger"),E=(D.LoggingEvent,D.Logger),F="[all]",G={},H={},I={},J={},K={appenders:[{type:"console"}],replaceConsole:!1},L={},M={log:console.log,debug:console.debug,info:console.info,warn:console.warn,error:console.error};b.exports={getLogger:e,getDefaultLogger:m,hasLogger:d,addAppender:f,loadAppender:w,clearAppenders:i,configure:s,shutdown:x,replaceConsole:t,restoreConsole:u,levels:C,setGlobalLogLevel:l,layouts:B,appenders:{},appenderMakers:I,connectLogger:a("./connect-logger").connectLogger},s()}).call(this,a("_process"))},{"./connect-logger":30,"./layouts":32,"./levels":33,"./logger":35,_process:7,async:36,events:3,fs:1,path:6,util:9}],35:[function(a,b,c){"use strict";function d(a,b,c,d){this.startTime=new Date,this.categoryName=a,this.data=c,this.level=b,this.logger=d}function e(a,b){this.category=a||k,b&&this.setLevel(b)}function f(){l=!1}function g(){l=!0}var h=a("./levels"),i=a("util"),j=a("events"),k="[default]",l=!0;i.inherits(e,j.EventEmitter),e.DEFAULT_CATEGORY=k,e.prototype.level=h.TRACE,e.prototype.setLevel=function(a){this.level=h.toLevel(a,this.level||h.TRACE)},e.prototype.removeLevel=function(){delete this.level},e.prototype.log=function(){var a,b=Array.prototype.slice.call(arguments),c=h.toLevel(b.shift());this.isLevelEnabled(c)&&(a=new d(this.category,c,b,this),this.emit("log",a))},e.prototype.isLevelEnabled=function(a){return this.level.isLessThanOrEqualTo(a)},["Trace","Debug","Info","Warn","Error","Fatal"].forEach(function(a){var b=h.toLevel(a);e.prototype["is"+a+"Enabled"]=function(){return this.isLevelEnabled(b)},e.prototype[a.toLowerCase()]=function(){if(l&&this.isLevelEnabled(b)){var a=Array.prototype.slice.call(arguments);a.unshift(b),e.prototype.log.apply(this,a)}}}),c.LoggingEvent=d,c.Logger=e,c.disableAllLogWrites=f,c.enableAllLogWrites=g},{"./levels":33,events:3,util:9}],36:[function(a,b){b.exports=a("./lib/async")},{"./lib/async":37}],37:[function(a,b){(function(a){!function(){var c={},d=this,e=d.async;"undefined"!=typeof b&&b.exports?b.exports=c:d.async=c,c.noConflict=function(){return d.async=e,c};var f=function(a,b){if(a.forEach)return a.forEach(b);for(var c=0;c<a.length;c+=1)b(a[c],c,a)},g=function(a,b){if(a.map)return a.map(b);var c=[];return f(a,function(a,d,e){c.push(b(a,d,e))}),c},h=function(a,b,c){return a.reduce?a.reduce(b,c):(f(a,function(a,d,e){c=b(c,a,d,e)}),c)},i=function(a){if(Object.keys)return Object.keys(a);var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b};c.nextTick="undefined"!=typeof a&&a.nextTick?a.nextTick:function(a){setTimeout(a,0)},c.forEach=function(a,b,c){if(!a.length)return c();var d=0;f(a,function(e){b(e,function(b){b?(c(b),c=function(){}):(d+=1,d===a.length&&c())})})},c.forEachSeries=function(a,b,c){if(!a.length)return c();var d=0,e=function(){b(a[d],function(b){b?(c(b),c=function(){}):(d+=1,d===a.length?c():e())})};e()},c.forEachLimit=function(a,b,c,d){if(!a.length||0>=b)return d();var e=0,f=0,g=0;!function h(){if(e===a.length)return d();for(;b>g&&f<a.length;)c(a[f],function(b){b?(d(b),d=function(){}):(e+=1,g-=1,e===a.length?d():h())}),f+=1,g+=1}()};var j=function(a){return function(){var b=Array.prototype.slice.call(arguments);return a.apply(null,[c.forEach].concat(b))}},k=function(a){return function(){var b=Array.prototype.slice.call(arguments);return a.apply(null,[c.forEachSeries].concat(b))}},l=function(a,b,c,d){var e=[];b=g(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c,d){e[a.index]=d,b(c)})},function(a){d(a,e)})};c.map=j(l),c.mapSeries=k(l),c.reduce=function(a,b,d,e){c.forEachSeries(a,function(a,c){d(b,a,function(a,d){b=d,c(a)})},function(a){e(a,b)})},c.inject=c.reduce,c.foldl=c.reduce,c.reduceRight=function(a,b,d,e){var f=g(a,function(a){return a}).reverse();c.reduce(f,b,d,e)},c.foldr=c.reduceRight;var m=function(a,b,c,d){var e=[];b=g(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c){c&&e.push(a),b()})},function(){d(g(e.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})};c.filter=j(m),c.filterSeries=k(m),c.select=c.filter,c.selectSeries=c.filterSeries;var n=function(a,b,c,d){var e=[];b=g(b,function(a,b){return{index:b,value:a}}),a(b,function(a,b){c(a.value,function(c){c||e.push(a),b()})},function(){d(g(e.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})};c.reject=j(n),c.rejectSeries=k(n);var o=function(a,b,c,d){a(b,function(a,b){c(a,function(c){c?(d(a),d=function(){}):b()})},function(){d()})};c.detect=j(o),c.detectSeries=k(o),c.some=function(a,b,d){c.forEach(a,function(a,c){b(a,function(a){a&&(d(!0),d=function(){}),c()})},function(){d(!1)})},c.any=c.some,c.every=function(a,b,d){c.forEach(a,function(a,c){b(a,function(a){a||(d(!1),d=function(){}),c()})},function(){d(!0)})},c.all=c.every,c.sortBy=function(a,b,d){c.map(a,function(a,c){b(a,function(b,d){b?c(b):c(null,{value:a,criteria:d})})},function(a,b){if(a)return d(a);var c=function(a,b){var c=a.criteria,d=b.criteria;return d>c?-1:c>d?1:0};d(null,g(b.sort(c),function(a){return a.value}))})},c.auto=function(a,b){b=b||function(){};var c=i(a);if(!c.length)return b(null);var d={},e=[],g=function(a){e.unshift(a)},j=function(a){for(var b=0;b<e.length;b+=1)if(e[b]===a)return void e.splice(b,1)},k=function(){f(e,function(a){a()})};g(function(){i(d).length===c.length&&b(null,d)}),f(c,function(c){var e=a[c]instanceof Function?[a[c]]:a[c],f=function(a){if(a)b(a),b=function(){};else{var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),d[c]=e,k()}},i=e.slice(0,Math.abs(e.length-1))||[],l=function(){return h(i,function(a,b){return a&&d.hasOwnProperty(b)},!0)};if(l())e[e.length-1](f,d);else{var m=function(){l()&&(j(m),e[e.length-1](f,d))};g(m)}})},c.waterfall=function(a,b){if(!a.length)return b();b=b||function(){};var d=function(a){return function(e){if(e)b(e),b=function(){};else{var f=Array.prototype.slice.call(arguments,1),g=a.next();f.push(g?d(g):b),c.nextTick(function(){a.apply(null,f)})}}};d(c.iterator(a))()},c.parallel=function(a,b){if(b=b||function(){},a.constructor===Array)c.map(a,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);c.length<=1&&(c=c[0]),b.call(null,a,c)})},b);else{var d={};c.forEach(i(a),function(b,c){a[b](function(a){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),d[b]=e,c(a)})},function(a){b(a,d)})}},c.series=function(a,b){if(b=b||function(){},a.constructor===Array)c.mapSeries(a,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);c.length<=1&&(c=c[0]),b.call(null,a,c)})},b);else{var d={};c.forEachSeries(i(a),function(b,c){a[b](function(a){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),d[b]=e,c(a)})},function(a){b(a,d)})}},c.iterator=function(a){var b=function(c){var d=function(){return a.length&&a[c].apply(null,arguments),d.next()};return d.next=function(){return c<a.length-1?b(c+1):null},d};return b(0)},c.apply=function(a){var b=Array.prototype.slice.call(arguments,1);return function(){return a.apply(null,b.concat(Array.prototype.slice.call(arguments)))}};var p=function(a,b,c,d){var e=[];a(b,function(a,b){c(a,function(a,c){e=e.concat(c||[]),b(a)})},function(a){d(a,e)})};c.concat=j(p),c.concatSeries=k(p),c.whilst=function(a,b,d){a()?b(function(e){return e?d(e):void c.whilst(a,b,d)}):d()},c.until=function(a,b,d){a()?d():b(function(e){return e?d(e):void c.until(a,b,d)})},c.queue=function(a,b){var d=0,e={tasks:[],concurrency:b,saturated:null,empty:null,drain:null,push:function(a,d){e.tasks.push({data:a,callback:d}),e.saturated&&e.tasks.length==b&&e.saturated(),c.nextTick(e.process)},process:function(){if(d<e.concurrency&&e.tasks.length){var b=e.tasks.shift();e.empty&&0==e.tasks.length&&e.empty(),d+=1,a(b.data,function(){d-=1,b.callback&&b.callback.apply(b,arguments),e.drain&&e.tasks.length+d==0&&e.drain(),e.process()})}},length:function(){return e.tasks.length},running:function(){return d}};return e};var q=function(a){return function(b){var c=Array.prototype.slice.call(arguments,1);b.apply(null,c.concat([function(b){var c=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(b?console.error&&console.error(b):console[a]&&f(c,function(b){console[a](b)}))}]))}};c.log=q("log"),c.dir=q("dir"),c.memoize=function(a,b){var c={},d={};b=b||function(a){return a};var e=function(){var e=Array.prototype.slice.call(arguments),f=e.pop(),g=b.apply(null,e);g in c?f.apply(null,c[g]):g in d?d[g].push(f):(d[g]=[f],a.apply(null,e.concat([function(){c[g]=arguments;var a=d[g];delete d[g];for(var b=0,e=a.length;e>b;b++)a[b].apply(null,arguments)}])))};return e.unmemoized=a,e},c.unmemoize=function(a){return function(){return(a.unmemoized||a).apply(null,arguments)}}}()}).call(this,a("_process"))},{_process:7}],38:[function(a,b){{var c=a("jclass"),d=a("node-event-emitter");b.exports=c._extend(d.prototype)}},{jclass:13,"node-event-emitter":15}],39:[function(a,b){var c=a("jclass"),d=c._extend({setState:function(){},getState:function(){},getFPS:function(){return 30},getWorld:function(){return this.world},init:function(){},update:function(){},project:function(){}});b.exports=d},{jclass:13}],40:[function(a,b){(function(c){var d=a("hasharray"),e=(a("jclass"),a("./ReckonerBase")),f=30,g=.3,h=30,i=e._extend({init:function j(a){j._super.call(this),this.pomelo=a,this.messaging=a.get("messagingService"),this.games=new d("rid"),this.lastTime=void 0,this.elapsed=void 0,this.id="sid:"+Math.round(100*Math.random()).toString(16)+":"+c.pid,this.interval=void 0},getNow:function(){return(new Date).getTime()},addGame:function(a,b){a.messaging=this.messaging,a.clientUpdateTimer=0,a.rid=b,this.games.add(a)},sendState:function(){this.games.all.forEach(function(a){var b=this.pomelo.get("channelService").getChannel(a.rid,!1);b?b.pushMessage("serverState",a.getState()):console.log("WARNING: attempted to push to channel but does not exist",a.rid)})},start:function(){this.interval=setInterval(this.frameHandler.bind(this),1e3/f)},stopAll:function(){clearInterval(this.interval)},resetAll:function(){this.games.all.forEach(function(){game.reset(),game.start()})},frameHandler:function(){return this.lastTime?(this.elapsed=(this.getNow()-this.lastTime)/1e3,this.lastTime=this.getNow(),this.elapsed=this.elapsed>g?g:this.elapsed,this.games.forEach(function(a){a.serverUpdate(this.elapsed)}),this.clientUpdateTimer+=this.elapsed,void(this.clientUpdateTimer>h/1e3&&(this.sendState(),this.clientUpdateTimer=0))):this.lastTime=this.getNow()},session_userInputHandler:function(a,b){var c=this.games.get(a.rid);c?c.addUserInputForSession(b.uid,a):console.log("ERROR: unable to find game for rid: "+a.rid)},session_disconnectedHandler:function(a){console.log("SESSION DISCONNECTED:",a),this.game.world.players.removeByKey(a),this.game.world.getChildren().get(a).destroy(),0==this.game.world.getChildren().getAsArray("player").length&&this.reset()},session_connectedHandler:function(a,b){var c=this.games.get(b);return c?(c.startSession=c.startSession||a,c.addSession(a),void console.log("SESSION CONNECTED:",a.uid," to ",b)):void console.log("Attempted to connect to game that does not exist: "+b)}});b.exports=i}).call(this,a("_process"))},{"./ReckonerBase":39,_process:7,hasharray:11,jclass:13}],41:[function(a,b){var c=a("merge"),d=a("./features/FeatureManager"),e=(a("jclass"),a("hasharray")),f=a("../EventDispatcher"),g=b.exports=f._extend({isServer:function(){return"undefined"==typeof window},stateSetProps:function(){return[]},stateGetProps:function(){return["_id"]},setParent:function(a){this._parent=a},getParent:function(){return this._parent},setChildren:function(a){this._children=a},getChildren:function(){return this._children},setId:function(a){this._id=a},getId:function(){return this._id||(this._id=this.randomId())},setState:function(a){this._state=a},getState:function(a){return this.inited?this.merge.recursive(!0,{id:this.getId(),type:this.type,children:this.getChildren().all.map(function(a){return a.getState()})},a):{}},getChildrenIds:function(){if(!this.inited)return{};var a={};return this.getChildren().all.forEach(function(b){a[b.getId()]=!0}),a},setChildrenState:function(a){var b=this,c=this.getChildrenIds();if(a.forEach(function(a){var d=b.getChildren().get(a.id);if(d){if("[object Array]"===Object.prototype.toString.call(d))return void console.log("Two ids are the same!",d[0].getId());d.setState(a)}else b.getChildren().add(b.newChildFromState(a));delete c[a.id]}),this.destroyUnfoundChildrenOnStateSet)for(var d in c)this.destroyChildById(d)
},getChildrenState:function(){return this.inited?this.getChildren().all.map(function(a){return a.getState()}):{}},setDirty:function(a){this._dirty=a,this._dirty&&this.getParent()?this.getParent().setDirty(!0):"",this._dirty?"":this.getChildren().forEach(function(a){a.setDirty(!1)})},getDirty:function(){return this._dirty},emit:function(){this._super.apply(this,arguments);var a=this.getParent();a&&a.emit.apply(a,arguments)},randomId:function(){return Math.round(999999999*Math.random()).toString(16)},init:function(a,b){a||(g.prototype.world=g.prototype.root=this),this.merge=c,this.setId(b),this.type="GameObject",this.buildChildrenObject(),this.setParent(a),this.setDirty(!0),this.destroyed=!1,this.sprite=void 0,this.destroyUnfoundChildrenOnStateSet=!0,this.pre=new d(this),this.post=new d(this),this.inited=!0},update:function(a,b){b&&b.add(this);var c=this;this.pre.update(a),this.getChildren().all.concat().forEach(function(a){a.destroyed&&c.getChildren().remove(a)}),this.getChildren().all.forEach(function(c){c.update(a,b)}),this.post.update(a)},newChildFromState:function(a){var b=new g;return b.init(this,a.id),b.state=a,b},destroyChildById:function(a){var b=this.getChildren().get(a);return b?(b.destroy&&b.destroy(),void this.getChildren().remove(b)):void console.log("Attempting to destroy non-existent child with id",a)},buildChildrenObject:function(){this.setChildren(new e(["_id","type"]))},buildSprite:function(){},updateSprite:function(a){this.sprite&&this.destroyed?this.sprite.destroy(!0):(this.sprite||this.buildSprite(a),this.sprite&&this.sprite.updateWithModel(this))},updatePhaser:function(a){this.getChildren().all.forEach(function(b){b.updatePhaser(a)}),this.updateSprite(a)},destroy:function(){this.destroyed=!0},forEach:function(a,b){var c=b?this.getChildren().getAll(b):this.getChildren().all.concat();c.forEach(function(c){c.forEach(a,b)}),(!b||b.indexOf(this.type))&&a.apply(this)}})},{"../EventDispatcher":38,"./features/FeatureManager":42,hasharray:11,jclass:13,merge:14}],42:[function(a,b){var c=a("hasharray"),d=function(a){this.gameObject=a,this.features=new c(["name"])};d.prototype={cache:{},add:function(a){this.features.add(a)},update:function(a){var b=this;this.cache={},this.features.all.forEach(function(c){c.applyUpdate(b.gameObject,a,b.cache)})}},b.exports=d},{hasharray:11}],43:[function(a,b){var c=a("jclass"),d=c._extend({init:function(a){this.app=a},enter:function(a,b,c){var d=this,e=a.rid,f=a.username+"*"+e,g=this.app.get("sessionService");return g.getByUid(f)?c(null,{code:500,error:!0,errorText:"Username already exists:"+a.username+" for this channel "+e}):(b.bind(f),b.set("rid",e),b.push("rid",function(a){a&&console.error("Set rid for session service failed! error is : %j",a.stack)}),b.on("closed",this.session_closedHandler.bind(this)),void this.app.rpc.skyduel.skyduelRemote.add(b,f,d.app.get("serverId"),e,!0,this.reckonerRemote_addCallback.bind(this,c)))},session_closedHandler:function(a,b){b&&b.uid&&a.rpc.skyduel.skyduelRemote.kick(b,b.uid,a.get("serverId"),b.get("rid"),null)},reckonerRemote_addCallback:function(a,b){a(null,{users:b})}});b.exports=function(a){return new d(a)}},{jclass:13}],44:[function(a,b){function c(a,b){return b[Math.abs(crc.crc32(a))%b.length]}var d=a("jclass"),e=d._extend({init:function(a){this.app=a},requestConnectorForClient:function(a,b,d){var e=a.clientId;if(!e)return void d(null,{code:500,reason:"no clientId provided"});var f=this.app.getServersByType("connector");if(!f||0===f.length)return void d(null,{code:500,reason:"no connectors found"});var g=c(e,f);d(null,{code:200,host:g.host,port:g.clientPort})}});b.exports=function(a){return new e(a)}},{jclass:13}],45:[function(a){(function(b,c){var d=a("jclass"),e=a("pomelo");c.isClient=!1;d._extend({init:function(a,b,c){this.app=e.createApp(),this.gameServerClass=b,this.options=c||{},this.app.set("name",a),this.configure()},start:function(){app.start()},configure:function(){this.setupConnector(),this.setupGate(),this.setupReckoner(),this.setupAll()},setupConnector:function(){this.app.configure("production|development|staging","connector",this.setupConnectorHandler.bind(this))},setupConnectorHandler:function(){this.app.set("connectorConfig",this.options.connector||{connector:e.connectors.hybridconnector,heartbeat:3,useDict:!0,useProtobuf:!0})},setupAll:function(){this.app.configure("production|development|staging",this.setupAllHandler.bind(this))},setupAllHandler:function(){this.options.pidFile&&fs.appendFileSync(pidFile,b.pid.toString()+"\n"),this.app.route(this.name,routeUtil[this.name]),this.app.filter(e.timeout())},setupGate:function(){this.app.configure("production|development|staging","gate",this.setupGateHandler.bind(this))},setupGateHandler:function(){this.app.set("connectorConfig",this.options.gate||{connector:e.connectors.hybridconnector,useProtobuf:!0})},setupReckoner:function(){this.app.configure("production|development|staging",this.name,this.setupReckonerHandler.bind(this))},setupReckonerHandler:function(){this.app.set(name+"Service",new this.gameServerClass(this.app))}})}).call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:7,jclass:13,pomelo:16}],46:[function(a,b,c){var d=a("jclass"),e=d._extend({init:function(a){this.app=a,this.channelService=a.get("channelService"),this.service=a.get("reckonerService")},add:function(a,b,c,d,e){var f=this.channelService.getChannel(c,d),g=a.split("*")[0],h={route:"onAdd",user:g};f.pushMessage(h),f&&f.add(a,b),e(this.getUserList(c,d))},getUserList:function(a,b){var c=this.channelService.getChannel(a,b),d=c?c.getMembers():[];return d.map(function(a){return a.split("*")[0]})},kick:function(a,b,c,d){var e=a.split("*")[0],f={route:"onLeave",user:e},g=this.channelService.getChannel(c,!1);g&&g.leave(a,b),g.pushMessage(f),this.service.session_disconnectedHandler(a),d()}});c=b.exports=function(a){return new e(a)}},{jclass:13}],47:[function(a,b){var c=a("reckoner"),d=c.Client._extend({init:function e(){e._super.call(this)}});b.exports=d},{reckoner:10}]},{},[47]);